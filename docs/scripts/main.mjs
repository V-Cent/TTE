var e=class e{isNavigationLocked;currentActiveSearchType;addPageChangeEventCallback;helperObj;searchBoxSelector=`#nav-bar__searchbox`;searchInputSelector=`#nav-bar__search--input`;searchHrSelector=`#nav-bar__search--hr`;static HARDCODED_FILTERS=[`TALES OF`,`T`,`TO`];static MAX_TECH_RESULTS=12;constructor(e,t){this.isNavigationLocked=!1,this.currentActiveSearchType=null,this.addPageChangeEventCallback=e,this.helperObj=t,this.handleSearchBoxClick=this.handleSearchBoxClick.bind(this),this.handleInputKeyUp=this.handleInputKeyUp.bind(this),this.handleInputFocusIn=this.handleInputFocusIn.bind(this),this.handleSearchBoxFocusOut=this.handleSearchBoxFocusOut.bind(this)}initializeSearchIcons(){let e=document.querySelector(this.searchBoxSelector);if(!e)return;e.addEventListener(`click`,this.handleSearchBoxClick);let t=document.querySelector(this.searchInputSelector);t&&(t.addEventListener(`keyup`,this.handleInputKeyUp),t.addEventListener(`focusin`,this.handleInputFocusIn)),e.targetParam=`search`;let n=document.querySelector(`#nav-bar__games--icon`);n?.addEventListener(`click`,this.performGamesSearch.bind(this)),e.addEventListener(`focusout`,this.handleSearchBoxFocusOut)}initializeOnboardingIcon(){let e=document.querySelector(`#content__home__onboarding--icon`);e?.addEventListener(`click`,this.performGamesSearch.bind(this))}handleSearchBoxClick(e){if(this.isNavigationLocked)return;let t=e.currentTarget;if(!t||!(t instanceof HTMLElement))return;let n=t,r=n.targetParam;r&&(this.currentActiveSearchType=r,this.displaySearchBox(`#nav-bar__search`))}displaySearchBox(e){if(this.isNavigationLocked)return;let t=document.querySelector(e);if(!t)return;t.removeEventListener(`click`,this.handleSearchBoxClick);let n=`${e}box`,r=`${e}--input`,i=document.querySelector(n),a=document.querySelector(r);if(!i)return;let{clientWidth:o}=document.body,s=this.currentActiveSearchType===`search`&&o>=480?400:280;i.style.width=`${s}px`,this.currentActiveSearchType===`search`?a?.focus():i.focus()}handleSearchBoxFocusOut(e){let t=document.querySelector(`#nav-bar__search`);t&&(e.stopPropagation(),(!(e.relatedTarget instanceof Node)||!t.contains(e.relatedTarget))&&this.clearSearchResults())}handleInputKeyUp(){this.filterSearchResults().then()}handleInputFocusIn(){this.filterSearchResults().then()}clearSearchResults(){let e=document.querySelector(this.searchBoxSelector);if(!e)return;this.isNavigationLocked=!0;let t=Array.from(e.getElementsByClassName(`button__redirect`)).filter(e=>e instanceof HTMLElement);for(let e of t)e.style.display=`none`;let n=document.querySelector(this.searchHrSelector);n&&(n.style.display=`none`),e.addEventListener(`click`,this.handleSearchBoxClick),this.isNavigationLocked=!1}async filterSearchResults(){let t=`#nav-bar__search`,n=document.querySelector(`.nav-bar__search--results`);n||await this.populateSearchResults();let r=document.querySelector(`${t}--input`);if(!r)return;let i=r.value.toUpperCase().trim(),a=i.split(` `),o=document.querySelector(`${t}box`);if(!o)return;let s=Array.from(o.getElementsByClassName(`button__redirect`)).filter(e=>e instanceof HTMLElement),c=0;for(let t of s){let n=this.shouldShowSearchResult(t,a,i);if(n){let n=e.HARDCODED_FILTERS.some(e=>e===i||e.includes(i));if(n&&t.dataset.tag===`game`){t.style.display=`flex`;continue}else if(n){t.style.display=`none`;continue}let r=c<e.MAX_TECH_RESULTS||t.dataset.tag===`game`;t.style.display=r?`flex`:`none`,r&&c++}else t.style.display=`none`}this.updateSearchSeparator(c,i)}shouldShowSearchResult(e,t,n){if(n.length===0)return!1;let r=[e.textContent??e.innerText??``,e.dataset.section??``,e.dataset.document??``].join(` `).toUpperCase();return t.every(e=>r.includes(e))}updateSearchSeparator(t,n){let r=document.querySelector(this.searchHrSelector);if(!r)return;let i=e.HARDCODED_FILTERS.some(e=>e===n||e.includes(n)),a=n.length>0&&(t>0||i);r.style.display=a?`block`:`none`}performGamesSearch(){let e=document.querySelector(this.searchBoxSelector);if(!e)return;this.clearSearchResults(),this.isNavigationLocked=!1;let t=document.querySelector(this.searchInputSelector);t&&(t.value=`Tales of`,t.focus())}async populateSearchResults(){let e=document.querySelector(this.searchBoxSelector);if(e)try{let{cachedSearchResultsHTML:t}=await import(`./searchHTML-BZgYzALO.mjs`),n=await this.helperObj.decompress(t),r=`<div id="nav-bar__search-results-container">${n}</div>`;e.insertAdjacentHTML(`beforeend`,`<hr id="nav-bar__search--hr" tabindex="0" style="display: none;">`+r);let i=document.querySelectorAll(`a.nav-bar__search--results`);for(let e of i)e instanceof HTMLElement&&this.addPageChangeEventCallback(e);e.focus()}catch(e){console.error(`Failed to load search results:`,e)}}async revealElementById(e){let t=document.getElementById(e);if(!t){let n=this.findH2SectionIndex(e);if(n===-1)return;let r=document.querySelectorAll(`.content__selectorbox--item`);r[n]?.click(),await new Promise(e=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}),t=document.getElementById(e)}if(!t)return;let n=this.getHiddenElementClasses(t);if(n)for(let e of n)await this.revealElementsByClassName(e)}findH2SectionIndex(e){let t=this.helperObj.h2Collection;return t?t.findIndex(t=>t.content.includes(`id="${e}"`)||t.id===e):-1}getHiddenElementClasses(e){if(e.tagName===`H4`&&e.dataset.open)return e.dataset.open.split(` `);let t=e.parentNode;if(t?.className.includes(`content__`)){let e=t.firstElementChild;if(e?.dataset.open)return e.dataset.open.split(` `)}let n=t?.parentNode;if(n){let e=n.firstElementChild;if(e?.dataset.open)return e.dataset.open.split(` `)}return null}async revealElementsByClassName(e){let t=document.getElementsByClassName(e);for(let e of t){if(!(e instanceof HTMLElement)||!e.hidden)continue;e.hidden=!1,this.updateExpandIcon(e)}await new Promise(e=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})})}updateExpandIcon(e){let t=e=>{let t=e.parentNode;if(t?.className.includes(`content__`))return t.firstElementChild?.children[0]??null;let n=t?.parentNode;return n?.firstElementChild?.children[0]??null},n=t(e);n instanceof HTMLElement&&n.classList.contains(`rotated`)&&n.classList.remove(`rotated`)}},t=class e{headings;ticking;helperObj;static VIEWPORT_THRESHOLD_RATIO=.25;static MIN_THRESHOLD_PIXELS=150;static TOC_OFFSET_PIXELS=-30;static MOBILE_TOC_WIDTH_BREAKPOINT=480;static MOBILE_TOC_WIDTH_LARGE=360;static MOBILE_TOC_WIDTH_SMALL=300;constructor(e){this.headings=[],this.ticking=!1,this.helperObj=e,document.addEventListener(`scroll`,this.handleScroll.bind(this),{passive:!0})}handleScroll(){!this.ticking&&this.helperObj.inTechPage&&(window.requestAnimationFrame(()=>{this.highlightTOC(),this.ticking=!1}),this.ticking=!0)}clearHeadings(){this.headings.length=0}createTOC(e){let t=this.initializeTOCElements();if(!t)return;let{tocBorder:n,selector:r,toc:i,tocMobile:a}=t;n.style.height=`calc(100% - ${r.offsetTop+150}px)`;let o=`<p>ON THIS SECTION</p><hr>`;i.innerHTML=o,a.innerHTML=o,this.populateHeadings();let s=this.generateTOCLinks(e);i.innerHTML=o.concat(s),a.innerHTML=o.concat(s)}initializeTOCElements(){let e=document.getElementById(`content__tocborder`),t=document.getElementById(`content__selector`),n=document.getElementById(`content__toc`),r=document.getElementById(`content__tocmobile`);if(!e){let i=this.createTOCElements();if(!i)return null;e=document.getElementById(`content__tocborder`),t=document.getElementById(`content__selector`),n=document.getElementById(`content__toc`),r=document.getElementById(`content__tocmobile`)}return!e||!t||!n||!r?null:{tocBorder:e,selector:t,toc:n,tocMobile:r}}createTOCElements(){let t=document.querySelector(`.content__selectorbox--item.selected`);if(!t)return null;let n=document.getElementById(`content`),r=document.getElementById(`content__selector`);if(!n||!r)return null;let i=document.createElement(`div`);i.id=`content__tocborder`,n.appendChild(i);let a=document.createElement(`div`);if(a.id=`content__toc`,i.appendChild(a),this.helperObj.inEdit){let t=document.getElementById(`edit-content`);t&&(i.style.top=`${r.offsetTop+n.offsetTop-t.clientHeight+e.TOC_OFFSET_PIXELS*3}px`)}else i.style.top=`${r.offsetTop+n.offsetTop+e.TOC_OFFSET_PIXELS}px`;return this.createMobileTOCElements(),this.setupTOCEventListeners(),{tocBorder:i,selector:r,content:n}}createMobileTOCElements(){let e=document.getElementById(`section-container__div`);if(!e)return;let t=document.createElement(`span`);t.className=`material-symbols-rounded`,t.id=`content__tocicon`,t.innerHTML=`menu_book`,t.style.display=`none`,e.appendChild(t);let n=document.createElement(`div`);n.id=`content__tocicon--box`,n.tabIndex=0,n.style.width=`0px`,e.appendChild(n);let r=document.createElement(`div`);r.id=`content__tocmobile`,n.appendChild(r),this.helperObj.dragScrollElement(`#${n.id}`,1),this.helperObj.dragScrollElement(`#content__toc`,1)}setupTOCEventListeners(){let e=document.getElementById(`content__tocicon`),t=document.getElementById(`content__tocicon--box`);!e||!t||(e.addEventListener(`click`,()=>this.handleTOCIconClick()),t.addEventListener(`focusout`,e=>{this.handleTOCBoxFocusOut(e)}))}handleTOCIconClick(){let t=document.getElementById(`content__tocicon--box`);if(!t)return;let n=document.body.clientWidth>=e.MOBILE_TOC_WIDTH_BREAKPOINT?e.MOBILE_TOC_WIDTH_LARGE:e.MOBILE_TOC_WIDTH_SMALL;Object.assign(t.style,{width:`${n}px`,display:`block`}),t.className=`fadein`,t.focus()}handleTOCBoxFocusOut(e){let t=document.getElementById(`content__tocicon--box`);t&&(e.stopPropagation(),t.className=`fadeout`)}populateHeadings(){this.headings.length=0;let e=document.querySelectorAll(`#content__currenth2 h3`),t=document.querySelectorAll(`#content__currenth2 h4`);for(let t of e)this.headings.push({name:t.textContent??``,clientY:t.getBoundingClientRect().top,isH3:!0,obj:t,id:t.id});for(let e of t)this.headings.push({name:e.textContent??``,clientY:e.getBoundingClientRect().top,isH3:!1,obj:e,id:e.id});this.headings.sort((e,t)=>e.clientY-t.clientY)}generateTOCLinks(e){let t=``;for(let n=0;n<this.headings.length;n++){let r=this.headings[n],i=r.isH3?``:` content__toc--search-h4`,a=`content__toc--search button__redirect${i}`;t+=`<div data-document="${e}" data-section="${this.helperObj.currentSection}" data-redirect="#${r.id}" class="${a}" style="display: block;">${r.name}</div>`}return t}highlightTOC(){let{currentH3:e,currentH3Index:t,nextH3Index:n}=this.findCurrentH3();this.updateTOCHighlighting(e),this.updateH4Visibility(t,n)}findCurrentH3(){let t=null,n=0,r=0;for(let i=0;i<this.headings.length;i++){let a=this.headings[i];if(!a.isH3)continue;let o=a.obj.getBoundingClientRect().top,s=Math.max(window.innerHeight*e.VIEWPORT_THRESHOLD_RATIO,e.MIN_THRESHOLD_PIXELS);if(o<=s||t===null)t=a,n=i;else{r=i;break}}return{currentH3:t,currentH3Index:n,nextH3Index:r}}updateTOCHighlighting(e){if(!e)return;let t=document.querySelectorAll(`.content__toc--search.active`);for(let e of t)e.classList.remove(`active`);let n=document.querySelectorAll(`.content__toc--search[data-redirect="#${e.id}"]`);for(let e of n)e.classList.add(`active`)}updateH4Visibility(e,t){for(let n=0;n<this.headings.length;n++){let r=this.headings[n];if(r.isH3)continue;let i=this.isH4WithinVisibleRange(n,e,t),a=document.querySelectorAll(`.content__toc--search[data-redirect="#${r.id}"]`);for(let e of a)i?(e.style.display=`block`,e.classList.add(`active`)):(e.style.display=`none`,e.classList.remove(`active`))}}isH4WithinVisibleRange(e,t,n){return e>=t&&e<=n||n===0&&t>0&&e>=t||n===0&&t===0}clearSectionTOC(){let e=[`content__tocicon`,`content__tocicon--box`];for(let t of e){let e=document.getElementById(t);e?.remove()}}};const n={yellow:`#f8d959`,pink:`#fe796f`,teal:`#45c9c9`,green:`#58f15b`,red:`#e74a41`,lavender:`#c8a2b0`,blue:`#205aaa`};var r=class{mouseDown;startX;scrollLeft;startY;scrollTop;scrollButton;rootElement;logoElement;rotateFlag;leaveCounter;currentVelocity;chromeVersionRegex=/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/;versionMap;currentSection;currentDocument;inTechPage;inEdit;addPageChangeEvent;fileList;h2Collection;constructor(e,t){this.mouseDown=!1,this.startX=0,this.scrollLeft=0,this.startY=0,this.scrollTop=0,this.scrollButton=null,this.rootElement=null,this.logoElement=null,this.rotateFlag=!1,this.leaveCounter=0,this.currentVelocity=0,this.versionMap=new Map,this.currentSection=void 0,this.currentDocument=void 0,this.inTechPage=!1,this.inEdit=!1,this.addPageChangeEvent=e,this.fileList=t,this.h2Collection=[]}updateStatus(e,t,n){this.currentDocument=e,this.currentSection=t,this.inTechPage=n,this.versionMap.clear()}logoInit(){let e=document.querySelector(`#nav-bar__title`);e?.addEventListener(`mouseenter`,this.startRotateLogo.bind(this)),e?.addEventListener(`mouseleave`,this.stopRotateLogo.bind(this)),this.logoElement=document.querySelector(`#nav-bar__title__logo`)}addLogoVelocity(){if(!this.rotateFlag&&this.leaveCounter===0){this.currentVelocity=4.7,this.leaveCounter=200,requestAnimationFrame(this.rotateLogo.bind(this));return}this.currentVelocity=4.7,this.leaveCounter=200}startRotateLogo(){!this.rotateFlag&&this.leaveCounter===0?(this.rotateFlag=!0,requestAnimationFrame(this.rotateLogo.bind(this))):(this.rotateFlag=!0,this.leaveCounter=200)}stopRotateLogo(){this.rotateFlag=!1}rotateLogo(){if(this.logoElement??=document.querySelector(`#nav-bar__title__logo`),!this.logoElement)return;let e=getComputedStyle(this.logoElement),t=e.getPropertyValue(`transform`);t===`none`&&(t=`matrix(1, 0, 0, 1, 0, 0)`);let n=t.split(`(`)[1].split(`)`)[0].split(`,`),r=parseFloat(n[0]),i=parseFloat(n[1]),a=Math.atan2(i,r)*(180/Math.PI);this.rotateFlag?this.currentVelocity=Math.min(this.currentVelocity+.06,1.8):this.currentVelocity=Math.max(this.currentVelocity-.03,0),a=a<0?a+360:a;let o=this.currentVelocity+a;if(this.logoElement.style.transform=`rotate(${o}deg)`,this.rotateFlag){this.leaveCounter=200,requestAnimationFrame(this.rotateLogo.bind(this));return}this.leaveCounter--,this.currentVelocity<=0&&(this.leaveCounter=0),this.leaveCounter>0&&requestAnimationFrame(this.rotateLogo.bind(this))}scrollInit(){this.scrollButton=document.querySelector(`#scroll__button--to-top`),this.rootElement=document.documentElement,this.scrollButton?.addEventListener(`click`,this.scrollToTop.bind(this)),window.addEventListener(`scroll`,this.handleScroll.bind(this))}handleScroll(){if(!this.rootElement)return;let e=this.rootElement.scrollHeight-this.rootElement.clientHeight,t=document.getElementById(`content__selectorbox`),n=0;if(t){let e=document.body.getBoundingClientRect(),r=t.getBoundingClientRect(),i=r.top-e.top;n=Math.max(i,0)}(this.rootElement.scrollTop-n)/e>.05?this.scrollButton?.classList.add(`scroll__button--to-top--show`):this.scrollButton?.classList.remove(`scroll__button--to-top--show`)}scrollToTop(){let e=document.getElementById(`content__selectorbox`),t=0;if(e){let n=document.body.getBoundingClientRect(),r=e.getBoundingClientRect(),i=r.top-n.top;t=Math.max(i-20,0)}window.requestAnimationFrame(()=>{let e=`smooth`;if(navigator.userAgent.includes(`Chrome`)){let t=navigator.userAgent.match(this.chromeVersionRegex),n=Number(t?.[1]??130);!isNaN(n)&&n<130&&(e=`auto`)}this.rootElement?.scrollTo({top:t,behavior:e})})}setTooltip(e,t){!e||!t||(e.addEventListener(`mouseover`,()=>{this.loadTooltip(e,t)},{passive:!0}),e.addEventListener(`mouseleave`,()=>{this.unloadTooltip()},{passive:!0}))}loadTooltip(e,t){if(!e)return;document.getElementsByTagName(`tooltip`)[0]?.remove();let n=document.createElement(`tooltip`);n.id=`nav-bar__tooltip`,n.textContent=t;let r=e.getBoundingClientRect();r.left<window.innerWidth/2?Object.assign(n.style,{top:`${r.bottom-10}px`,left:`${r.right}px`}):Object.assign(n.style,{top:`${r.bottom-10}px`,right:`${window.innerWidth-r.left-10}px`}),document.body.appendChild(n)}unloadTooltip(){document.getElementsByTagName(`tooltip`)[0]?.remove()}dragScrollElement(e,t){let n=document.querySelector(e);if(!n)return;let r=e=>e instanceof MouseEvent?{x:e.pageX,y:e.pageY}:{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},i=e=>{this.mouseDown=!0;let t=r(e);this.startX=t.x-n.offsetLeft,this.scrollLeft=n.scrollLeft},a=e=>{this.mouseDown=!0;let t=r(e);this.startY=t.y-n.offsetTop,this.scrollTop=n.scrollTop},o=e=>{if(e.stopPropagation(),!this.mouseDown)return;let t=r(e),i=t.x-n.offsetLeft,a=i-this.startX;n.scrollLeft=this.scrollLeft-a},s=e=>{if(e.stopPropagation(),!this.mouseDown)return;let t=r(e),i=t.y-n.offsetTop,a=i-this.startY;n.scrollTop=this.scrollTop-a},c=()=>{this.mouseDown=!1},l={passive:!1},u={passive:!0},d=t===1?[[`mousemove`,s,l],[`mousedown`,a,u],[`mouseup`,c,u],[`mouseleave`,c,u],[`touchmove`,s,l],[`touchstart`,a,u],[`touchend`,c,u]]:[[`mousemove`,o,l],[`mousedown`,i,u],[`mouseup`,c,u],[`mouseleave`,c,u],[`touchmove`,o,l],[`touchstart`,i,u],[`touchend`,c,u]];for(let[e,t,r]of d)n.addEventListener(e,t,r)}createMediaElement(e,t,n,r,i,a,o){let s=e.createElement(`p`),c=!!o;c?(s.classList.add(o===`left`?`content__figure--float-left`:`content__figure--float-right`),Object.assign(s.style,{opacity:`1`})):Object.assign(s.style,{opacity:`1`,textAlign:`center`});let l=e=>{try{let t=new URL(e,`https://dummy.invalid`),n=t.hostname.replace(/^www\./,``);if(n===`youtube.com`||n===`m.youtube.com`||n===`youtube-nocookie.com`){let e=t.searchParams.get(`v`);if(e)return e;let n=t.pathname.match(/\/embed\/([^/?#]+)/);if(n?.[1])return n[1];let r=t.pathname.match(/\/shorts\/([^/?#]+)/);if(r?.[1])return r[1]}if(n===`youtu.be`){let e=t.pathname.replace(/^\/+/,``).split(`/`)[0];return e||null}}catch{}return null},u;if(t===`img`){let t=e.createElement(`img`);Object.assign(t,{alt:a??``,loading:`lazy`,src:n}),u=t}else{let t=l(n);if(t){let n=e.createElement(`iframe`),r=`https://www.youtube.com/embed/${t}?rel=0`;Object.assign(n,{src:r,loading:`lazy`,title:a??`YouTube video`}),n.setAttribute(`frameborder`,`0`),n.setAttribute(`allow`,`accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share`),n.setAttribute(`allowfullscreen`,`true`),u=n}else{let t=e.createElement(`video`);Object.assign(t,{preload:`metadata`,controls:!0,muted:!0,loop:!0});let r=e.createElement(`source`);Object.assign(r,{src:n,type:`video/mp4`}),t.appendChild(r),u=t}}if(Object.assign(u,{draggable:!1}),c?Object.assign(u.style,{width:`100%`,height:`auto`,outline:`none`,borderRadius:`8px`,aspectRatio:r&&i?`${r} / ${i}`:`16 / 9`}):(u.tagName===`IFRAME`?(u.setAttribute(`width`,String(r)),u.setAttribute(`height`,String(i)),u.style.outline=`none`,u.style.borderRadius=`8px`,u.style.height=`${i}px`,u.style.width=`${r}px`):Object.assign(u,{width:r,height:i}),u.classList.add(`content__figure`)),s.appendChild(u),a){let t=e.createElement(`u`);t.classList.add(`content__figure-caption`),Object.assign(t.style,{whiteSpace:`pre`}),t.textContent=` ${a} `,s.appendChild(t)}return s}async asyncRead(e){let t=await this.loadFile(e);return!t||t.length<=1?``:t}async loadFile(e){return new Promise((t,n)=>{let r=new XMLHttpRequest;r.open(`GET`,e,!0),r.onload=()=>{r.status>=200&&r.status<300?t(r.response):n({status:r.status,statusText:r.statusText})},r.onerror=()=>{n({status:r.status,statusText:r.statusText})},r.send()})}async compress(e){let t=new TextEncoder,n=new ReadableStream({start(n){n.enqueue(t.encode(e)),n.close()}}),r=n.pipeThrough(new CompressionStream(`deflate-raw`)),i=new Response(r),a=await i.arrayBuffer();return typeof Buffer<`u`?Buffer.from(a).toString(`base64`):btoa(String.fromCharCode(...new Uint8Array(a)))}async decompress(e){let t;if(typeof Buffer<`u`)t=Buffer.from(e,`base64`);else{let n=atob(e);t=new Uint8Array(n.length);for(let e=0;e<n.length;e++)t[e]=n.charCodeAt(e)}let n=new ReadableStream({start(e){e.enqueue(t),e.close()}}),r=n.pipeThrough(new DecompressionStream(`deflate-raw`)),i=new Response(r);return await i.text()}},i=class e{colorCollection;helperObj;static CHEVRON_UPDATE_DELAY=700;constructor(e){this.colorCollection=n,this.helperObj=e,this.collapseHeadingStyle=this.collapseHeadingStyle.bind(this)}collapseHeadings(){this.helperObj.dragScrollElement(`#content__selectorbox`,0),this.setupChevrons();let e=document.getElementById(`content`);e!==null&&(e.style.visibility=`visible`)}setupChevrons(){let e=this.getChevronElements();if(!e)return;let{chevronBox:t,chevronLeft:n,chevronRight:r,selectorBox:i}=e,a=()=>{let e=i.clientWidth,a=i.scrollWidth;e<a?Object.assign(t.style,{display:`block`,left:`${i.getBoundingClientRect().right}px`}):t.style.display=`none`;let o=i.scrollLeft;n.classList.toggle(`active`,o>0),r.classList.toggle(`active`,o<a-e)};a(),this.setupChevronEventListeners(n,r,i,a)}getChevronElements(){let e=document.getElementById(`content__mobilechevrons`),t=document.querySelector(`.content__mobilechevrons--left`),n=document.querySelector(`.content__mobilechevrons--right`),r=document.getElementById(`content__selectorbox`);return!e||!t||!n||!r?null:{chevronBox:e,chevronLeft:t,chevronRight:n,selectorBox:r}}setupChevronEventListeners(e,t,n,r){window.addEventListener(`resize`,r),e.addEventListener(`click`,()=>{this.handleChevronClick(n,`left`,r)}),t.addEventListener(`click`,()=>{this.handleChevronClick(n,`right`,r)}),n.addEventListener(`scroll`,r)}handleChevronClick(t,n,r){let i=t.offsetWidth,a=n===`left`?Math.max(0,t.scrollLeft-i):Math.min(t.scrollWidth-i,t.scrollLeft+i);t.scrollTo({left:a,behavior:`smooth`}),setTimeout(()=>r(),e.CHEVRON_UPDATE_DELAY)}collapseHeadingStyle(e){let t=e.currentTarget;if(!t||!(t instanceof HTMLElement)||!t.dataset.open)return;let n=t.dataset.open.split(` `);for(let e of n){let r=e;this.toggleElementsByClassName(r,t,n.indexOf(r)===0)}}toggleElementsByClassName(e,t,n){let r=document.getElementsByClassName(e);for(let e of r){let r=e;if(!(r instanceof HTMLElement))continue;r.hidden?(r.hidden=!1,this.updateExpandIcon(t)):n&&(r.hidden=!0,this.updateExpandIcon(t))}}updateExpandIcon(e){let t=e.children[0];t instanceof HTMLElement&&(t.classList.contains(`rotated`)?t.classList.remove(`rotated`):t.classList.add(`rotated`))}shareHeadings(){let e=document.location.pathname.substring(1),t=e.split(`/`);t.length>1&&(e=t[0]);let n=window.location.origin,r=document.querySelectorAll(`h3, h4`);for(let t of r){let r=t;r.style.cursor=`copy`,r.addEventListener(`click`,()=>{let t=`${n}/${e}/${r.id}`;navigator.clipboard.writeText(t).catch(()=>{})})}}};const a=[{document:`./CONTRIBUTING`,section:`How to Contribute`,dim:`N/A`,ref:`contributing`},{document:`HOME`,section:`HOME`,dim:`N/A`,ref:``},{document:`./README`,section:`README`,dim:`N/A`,ref:`readme`},{document:`./STYLING`,section:`Document Styling`,dim:`N/A`,ref:`styling`},{document:`TOG`,section:`Tales of Graces`,dim:`3D`,ref:`tog`,platform:[`Wii`,`PS3`,`Switch`,`PS4`,`PS5`,`XB1`,`XBS`,`PC`],initialRelease:2009,latestRelease:2025,description:`Bonds Transcend Time`},{document:`TOG-B`,section:`Tales of Graces`,dim:`3D`,ref:`tog-b`},{document:`TOG-C`,section:`Tales of Graces`,dim:`3D`,ref:`tog-c`},{document:`TOA`,section:`Tales of Arise`,dim:`3D`,ref:`toa`,platform:[`PS4`,`PS5`,`XB1`,`XBS`,`PC`],initialRelease:2021,latestRelease:2023,description:`Challenge the Fate That Binds You`},{document:`TOA-B`,section:`Tales of Arise`,dim:`3D`,ref:`toa-b`},{document:`TOA-C`,section:`Tales of Arise`,dim:`3D`,ref:`toa-c`},{document:`TOV`,section:`Tales of Vesperia`,dim:`3D`,ref:`tov`,platform:[`360`,`PS3`,`Switch`,`PS4`,`PS5`,`XB1`,`XBS`,`PC`],initialRelease:2008,latestRelease:2019,description:`To Each, Their Own Justice`},{document:`TOV-B`,section:`Tales of Vesperia`,dim:`3D`,ref:`tov-b`},{document:`TOV-C`,section:`Tales of Vesperia`,dim:`3D`,ref:`tov-c`},{document:`TODPS2`,section:`Tales of Destiny`,dim:`2D`,ref:`todps2`,platform:[`PS2`],initialRelease:2006,latestRelease:2008,description:`Liberate Your Destiny`},{document:`TODPS2-B`,section:`Tales of Destiny`,dim:`2D`,ref:`todps2-b`},{document:`TODPS2-C`,section:`Tales of Destiny`,dim:`2D`,ref:`todps2-c`},{document:`TOL`,section:`Tales of Legendia`,dim:`2D`,ref:`tol`,platform:[`PS2`],initialRelease:2005,latestRelease:2006,description:`Let Your Faith Give Birth to Power`},{document:`TOL-B`,section:`Tales of Legendia`,dim:`2D`,ref:`tol-b`},{document:`TOL-C`,section:`Tales of Legendia`,dim:`2D`,ref:`tol-c`},{document:`TOS`,section:`Tales of Symphonia`,dim:`3D`,ref:`tos`,platform:[`GCN`,`PS2`,`PS3`,`PC`,`Switch`,`PS4`,`XB1`],initialRelease:2003,latestRelease:2023,description:`The Epic Battle for Survival`},{document:`TOS-B`,section:`Tales of Symphonia`,dim:`3D`,ref:`tos-b`},{document:`TOS-C`,section:`Tales of Symphonia`,dim:`3D`,ref:`tos-c`},{document:`TOTA`,section:`Tales of the Abyss`,dim:`3D`,ref:`tota`,platform:[`PS2`,`3DS`],initialRelease:2005,latestRelease:2012,description:`Learning Why One Exists`},{document:`TOTA-B`,section:`Tales of the Abyss`,dim:`3D`,ref:`tota-b`},{document:`TOTA-C`,section:`Tales of the Abyss`,dim:`3D`,ref:`tota-c`},{document:`TOX`,section:`Tales of Xillia`,dim:`3D`,ref:`tox`,platform:[`PS3`],initialRelease:2011,latestRelease:2013,description:`When Worlds Overlap, Belief Lights the Way`},{document:`TOX-B`,section:`Tales of Xillia`,dim:`3D`,ref:`tox-b`},{document:`TOX-C`,section:`Tales of Xillia`,dim:`3D`,ref:`tox-c`},{document:`TOX2`,section:`Tales of Xillia 2`,dim:`3D`,ref:`tox2`,platform:[`PS3`],initialRelease:2012,latestRelease:2014,description:`The Power of Choice`},{document:`TOX2-B`,section:`Tales of Xillia 2`,dim:`3D`,ref:`tox2-b`},{document:`TOX2-C`,section:`Tales of Xillia 2`,dim:`3D`,ref:`tox2-c`},{document:`TOZ`,section:`Tales of Zestiria`,dim:`3D`,ref:`toz`,platform:[`PS3`,`PS4`,`PC`],initialRelease:2015,latestRelease:2016,description:`Legends Beget Hope`},{document:`TOZ-B`,section:`Tales of Zestiria`,dim:`3D`,ref:`toz-b`},{document:`TOZ-C`,section:`Tales of Zestiria`,dim:`3D`,ref:`toz-c`}];var o=class e{helperObj;static ARTICLE_SELECTOR_SELECTOR=`.content__article-selector`;static TAGGING_COMPUTED_SELECTOR=`.tagging-computed`;static VERSION_TRIGGER_SELECTOR=`[data-tte-version-trigger]`;static TODO_TRIGGER_SELECTOR=`[data-tte-todo-trigger]`;static MEDIA_ICON_SELECTOR=`[data-tte-media-icon]`;static TABLE_HEADERS_SELECTOR=`th`;static SPOILER_SELECTOR=`.spoiler`;handlePageChange;editPage;constructor(e,t,n){this.compileDirectives=this.compileDirectives.bind(this),this.sortTables=this.sortTables.bind(this),this.treatSpoilers=this.treatSpoilers.bind(this),this.handlePageChange=t,this.editPage=n,this.helperObj=e}compileEvents(){let t=document.querySelectorAll(e.TAGGING_COMPUTED_SELECTOR),n=document.querySelectorAll(e.ARTICLE_SELECTOR_SELECTOR);if(this.helperObj.inEdit){let e=document.querySelector(`div.content__article-selector`);e&&this.helperObj.setTooltip(e,`Article selection does not function on edit mode.`)}for(let e of n)this.setupArticleSelectorEventListeners(e);for(let e of t){let t=e,n=t.dataset.tags??`{}`,r=JSON.parse(n.replace(/'/g,`"`));if(r.versions&&this.setupVersionEventListeners(t,r.versions),r.todo&&this.setupTodoEventListeners(t),r.media&&r.forcedmedia===!1&&this.setupMediaEventListeners(t),t.classList.contains(`content__redirect`))if(r.document&&this.helperObj.inEdit){let e=`Redirects to: ${r.document} - ${r.redirect}`;this.helperObj.setTooltip(t,e)}else this.helperObj.addPageChangeEvent(t)}}setupArticleSelectorEventListeners(e){let t=e.querySelector(`.content__article-selector--button`),n=e.querySelector(`.content__article-selector--menu`),r=e.querySelectorAll(`.content__article-selector--item`);if(!t||!n||e.dataset.initialized===`true`)return;t.addEventListener(`click`,e=>{e.stopPropagation(),e.preventDefault(),this.toggleArticleSelector(t,n)});for(let i of r)i.addEventListener(`click`,r=>{r.stopPropagation(),r.preventDefault(),this.selectArticleSelectorItem(e,t,n,i)});let i=r=>{let i=r.target;e.contains(i)||this.closeArticleSelector(t,n)};document.addEventListener(`click`,i),t.addEventListener(`blur`,()=>{setTimeout(()=>{e.contains(document.activeElement)||this.closeArticleSelector(t,n)},150)}),e.dataset.initialized=`true`}toggleArticleSelector(e,t){let n=t.classList.contains(`open`);n?this.closeArticleSelector(e,t):this.openArticleSelector(e,t)}openArticleSelector(e,t){e.classList.add(`open`),t.classList.add(`open`),e.setAttribute(`aria-expanded`,`true`)}closeArticleSelector(e,t){e.classList.remove(`open`),t.classList.remove(`open`),e.setAttribute(`aria-expanded`,`false`)}selectArticleSelectorItem(e,t,n,r){if(this.helperObj.inEdit){this.closeArticleSelector(t,n);return}if(r.classList.contains(`content__article-selector--edit`)){this.closeArticleSelector(t,n),this.editPage({document:this.helperObj.currentDocument??``,section:this.helperObj.currentSection??``,pageType:`tech`});return}this.updateActiveItemState(e,r),this.updateButtonDisplay(t,r);let i=r.dataset.option;i&&(e.dataset.active=i),this.closeArticleSelector(t,n);let o=r.dataset.document;if(!o||!a.some(e=>e.document===o))return;let s={document:o??``,section:r.dataset.section??``,pageType:`tech`};this.handlePageChange(s)}updateActiveItemState(e,t){let n=e.querySelectorAll(`.content__article-selector--item:not(.content__article-selector--edit)`);for(let e of n)e.classList.remove(`active`);t.classList.add(`active`)}updateButtonDisplay(e,t){let n=t.querySelector(`.material-symbols-rounded`),r=t.textContent?.trim().replace(/^(group|swords|settings)\s*/,``)??``,i=e.querySelector(`.material-symbols-rounded:not(.content__article-selector--chevron)`);i&&n&&(i.textContent=n.textContent);let a=e.querySelector(`.content__article-selector--label`);a&&(a.textContent=r)}setupVersionEventListeners(t,n){let r=t.querySelector(e.VERSION_TRIGGER_SELECTOR);if(!r)return;let i=`Version: ${n}.`;this.helperObj.setTooltip(r,i)}setupTodoEventListeners(t){let n=t.querySelector(e.TODO_TRIGGER_SELECTOR);n&&this.helperObj.setTooltip(n,`This section needs work, is not confirmed or needs testing.`)}setupMediaEventListeners(t){let n=t.querySelector(e.MEDIA_ICON_SELECTOR);if(!n)return;let r=n.dataset.mediaSrc,i=n.dataset.mediaType,a=n.dataset.mediaCaption;!r||!i||n.addEventListener(`click`,()=>{this.handleMediaIconClick(t,r,i,a)},{passive:!0})}handleMediaIconClick(e,t,n,r){let i=document.querySelector(`p[data-media="${t}"]`);if(i){i.remove();return}let a=this.helperObj.createMediaElement(document,n,t,640,480,r);a.dataset.media=t,e.parentNode?.insertBefore(a,e.nextSibling)}compileDirectives(){this.compileEvents(),this.sortTables(),this.treatSpoilers()}sortTables(){let t=document.querySelectorAll(e.TABLE_HEADERS_SELECTOR);for(let e of t){let t=e;t.innerHTML+=`<span class="material-symbols-rounded">swap_vert</span>`,t.addEventListener(`click`,()=>{this.handleTableHeaderClick(t)})}}handleTableHeaderClick(e){let t=e.closest(`table`),n=t?.querySelector(`tbody`)??null;if(!n)return;let r=Array.from(n.querySelectorAll(`tr`)),i=Array.from(e.parentNode?.children??[]),a=i.indexOf(e),o=e.dataset.asc===`true`,s=!o,c=(e,t)=>e.children[t]?.textContent?.trim()??``,l=(e,t)=>(n,r)=>{let i=c(t?n:r,e),a=c(t?r:n,e);if(i===``||a===``)return i.localeCompare(a);let o=Number(i),s=Number(a);return!isNaN(o)&&!isNaN(s)?o-s:i.localeCompare(a)},u=r.toSorted(l(a,s));for(let e of u)n.appendChild(e);e.dataset.asc=s.toString()}treatSpoilers(){let t=document.querySelectorAll(e.SPOILER_SELECTOR);for(let e of t)e.addEventListener(`click`,e=>{let t=e.currentTarget;t instanceof HTMLElement&&(t.style.background=`transparent`)},{passive:!0})}};const s={CONTENT:`#content`,NAV_BAR:`#nav-bar`,SEARCH_INPUT:`#nav-bar__search--input`,CONTENT_CURRENT_H2:`#content__currenth2`,CONTENT_SELECTOR:`#content__selector`,META_DESCRIPTION:`meta[name="description"]`,H1:`h1`,TOC_SEARCH:`.content__toc--search`,SELECTOR_ITEM:`.content__selectorbox--item`,CONTENT_COLLAPSE:`.content__collapse`,CONTENT_REDIRECT:`span.content__redirect`,SHOWCASE_PLAY:`.content__games-play--videospan`,SHOWCASE_VIDEO:`.content__games__hero__video`,HOME_UPDATED:`.content__latest-changes__commit-changes-link`,HOME_GAMES:`.content__games__hero__article-item`},c={MIN_HEIGHT_STANDARD:`600px`,MIN_HEIGHT_TECH:`100vh`,REDIRECT_DELAY:100,VIDEO_FADE_DELAY:50,VIDEO_REMOVE_DELAY:500},l={helper:new r(_,a),headings:{},directives:{},search:{},toc:{}};l.headings=new i(l.helper),l.directives=new o(l.helper,S,le),l.search=new e(_,l.helper),l.toc=new t(l.helper);const u={parsedDocuments:new Map,currentDocument:``,katexLoaded:!1,pageContent:``};let d=!1,f=null,p=!1;document.readyState===`loading`?document.addEventListener(`DOMContentLoaded`,m):m();function m(){h(),ee(),te(),g()}function h(){let e=[`div#nav-bar__title`,`p.footer-container__help--links`,`img#title-text__img`];for(let t of e){let e=document.querySelectorAll(t);for(let t of e)_(t)}}function ee(){l.search.initializeSearchIcons(),l.search.initializeOnboardingIcon(),l.helper.scrollInit(),l.helper.logoInit()}function te(){window.addEventListener(`popstate`,e=>{e.preventDefault(),e.stopPropagation();let t=e.state?{...e.state,isPopstate:!0}:{document:`HOME`,section:`HOME`,pageType:`home`,isPopstate:!0};S(t).then()})}function g(){let e=document.location.pathname.substring(1);if(!e){let e=b({document:`HOME`,section:`HOME`});e.isPopstate=!0,S(e).then();return}let t=e.split(`/`),n=t[0]||``,r=t[1]||``,i=a.find(e=>e.ref===n);if(i){let t={document:i.document,section:i.section,redirect:r?`#${r}`:void 0},n=b(t);n.isPopstate=!0,S(n).then(),window.history.replaceState(n,i.section,e)}else{let e=b({document:`HOME`,section:`HOME`});S(e).then()}}function _(e){y(),e.removeEventListener(`click`,v),e.addEventListener(`click`,v)}function v(e){e.preventDefault(),e.stopPropagation(),y();let t=e.currentTarget;if(!(t instanceof HTMLElement))return;let n=b(t.dataset);S(n).then()}function y(){let e=document.querySelector(s.SEARCH_INPUT);e&&(document.activeElement?.blur(),e.blur())}function b(e){let t=e.document||``,n=e.section||``,r=e.redirect;return{document:t,section:n,redirect:r,pageType:x(t),isPopstate:!1}}function x(e){return e===`HOME`?`home`:e.includes(`./`)?`generic`:`tech`}async function S(e){(e.pageType===`tech`||e.pageType===`generic`&&e.document===`./STYLING`)&&await C(),await w(e),await ne(e)}async function C(){if(!u.katexLoaded)return new Promise(e=>{let t=document.createElement(`link`);Object.assign(t,{rel:`stylesheet`,crossOrigin:`anonymous`,href:`styles/katex.min.css`}),t.onload=()=>{u.katexLoaded=!0,e()},document.head.appendChild(t)})}async function w(e){l.search.clearSearchResults(),l.helper.addLogoVelocity(),u.pageContent=await T(e)}async function T(e){let t=e.document;if(u.parsedDocuments.has(t))return u.parsedDocuments.get(t)??``;let n=E(e),r=await l.helper.asyncRead(n);return u.parsedDocuments.set(t,r),r}function E(e){switch(e.pageType){case`home`:return`./${e.document.toLowerCase()}.html`;case`generic`:return`./${e.document}.html`;case`tech`:return`./tech/${e.document.toLowerCase()}.html`}}async function ne(e){let t=u.currentDocument===e.document;if(t&&e.pageType===`tech`&&e.redirect&&e.redirect!==`NONE`){await j(e),O(e);return}$(),u.currentDocument=e.document,re(e),D(e),O(e),A(e),await j(e)}function re(e){let t=document.getElementById(`content`);t&&(t.style.minHeight=e.pageType===`tech`?c.MIN_HEIGHT_TECH:c.MIN_HEIGHT_STANDARD,e.pageType===`tech`&&(t.style.visibility=`hidden`),l.toc.clearHeadings(),l.toc.clearSectionTOC(),l.helper.updateStatus(e.document,e.section,e.pageType===`tech`),t.innerHTML=u.pageContent,e.pageType===`tech`&&M())}function D(e){let t=e.pageType===`tech`?`TTE - ${e.section}`:`Tales Tech Encyclopaedia`,n=e.pageType===`tech`?`Tales Tech Encyclopaedia (TTE) article on ${e.section}.`:`Tales Tech Encyclopaedia (TTE), is a project that aims to document techniques and mechanics on the games of the 'Tales of Series'.`;document.title=t;let r=document.querySelector(s.META_DESCRIPTION);r?.setAttribute(`content`,n)}function O(e){if(e.isPopstate||l.helper.inEdit)return;let t=k(e);window.history.pushState(e,document.title,t)}function k(e){switch(e.pageType){case`home`:return`/`;case`generic`:return`/${e.document.toLowerCase()}`;case`tech`:{let t=`/${e.document.toLowerCase()}`;return e.redirect&&e.redirect!==`NONE`?`${t}/${e.redirect.substring(1)}`:t}}}function A(e){(e.pageType===`home`||e.pageType===`generic`)&&l.directives.compileDirectives(),l.toc.createTOC(u.currentDocument),W(),l.headings.shareHeadings(),e.pageType===`home`?(ae(),U(),l.search.initializeOnboardingIcon()):e.pageType===`tech`&&(l.headings.collapseHeadings(),G(),ce())}async function j(e){e.pageType===`tech`&&e.redirect&&e.redirect!==`NONE`?(await l.search.revealElementById(e.redirect.substring(1)),setTimeout(async()=>{let t=document.querySelector(e.redirect)??document.querySelector(s.CONTENT_SELECTOR);t?.scrollIntoView({behavior:`smooth`})},c.REDIRECT_DELAY)):ie()}function M(){let e=document.querySelector(s.H1);if(!e)return;let t=e.dataset.h2Collection;t&&(e.removeAttribute(`data-h2-collection`),l.helper.h2Collection=JSON.parse(t))}function ie(){document.querySelector(s.NAV_BAR)?.scrollIntoView({behavior:`smooth`})}function ae(){let e=document.querySelectorAll(`${s.CONTENT_REDIRECT}, ${s.HOME_UPDATED}, ${s.HOME_GAMES}`);for(let t of e)_(t)}function N(e){let t=e.currentTarget;t instanceof HTMLElement&&(t.textContent?.trim()===`play_arrow`?P(t):F(t))}function P(e){e.textContent=`stop`;let t=document.createElement(`video`);Object.assign(t,{src:e.dataset.video||``,className:`content__games__hero__video`,autoplay:!0,controls:!1,muted:!0,loop:!0}),e.parentElement?.parentElement?.appendChild(t),setTimeout(()=>{t.style.opacity=`1`},c.VIDEO_FADE_DELAY)}function F(e){let t=e.parentElement?.parentElement?.querySelector(`.content__games__hero__video`);t?(t.style.opacity=`0`,setTimeout(()=>{t.remove(),e.textContent=`play_arrow`},c.VIDEO_REMOVE_DELAY)):e.textContent=`play_arrow`}async function I(){if(p)return;let{cachedHomeGamesMenuHTML:e,cachedHomeGamesStackHTML:t}=await import(`./homeGamesHTML-B932FjQH.mjs`),[n,r]=await Promise.all([l.helper.decompress(e),l.helper.decompress(t)]),i=document.querySelector(`.content__games-menu-popup-desktop`);i&&i.innerHTML.trim().length===0&&(i.innerHTML=n);let a=document.querySelector(`.content__games-stack`);a&&r.trim().length>0&&a.insertAdjacentHTML(`beforeend`,r),p=!0;let o=document.querySelector(`.content__games-menu-popup:not(.content__games-mobile .content__games-menu-popup)`),c=document.querySelectorAll(`.content__games-menu__item`);for(let e of c)e.addEventListener(`click`,t=>{t.stopPropagation();let n=V();if(!n)return;let r=e.dataset.section,i=n.gameItems.findIndex(e=>e.dataset.section===r);i!==-1&&(H(n,`direct`,i),o&&e.closest(`.content__games-menu-popup`)?.parentElement===document.body&&B(o))});if(o){let e=o.querySelector(`.content__games-menu__icon--close`);e?.addEventListener(`click`,e=>{e.stopPropagation(),B(o)})}let u=document.querySelectorAll(`.content__games-prev`),d=document.querySelectorAll(`.content__games-next`);for(let e of u)e.addEventListener(`click`,()=>{H(f,`prev`).then()});for(let e of d)e.addEventListener(`click`,()=>{H(f,`next`).then()});let m=document.querySelectorAll(s.SHOWCASE_PLAY);for(let e of m)e.addEventListener(`click`,N);let h=document.querySelectorAll(`.content__games-menu__item-redirect, ${s.HOME_GAMES}`);for(let e of h)e instanceof HTMLElement&&_(e)}function L(){f=null,p=!1;let e=document.querySelectorAll(`.content__games-prev`),t=document.querySelectorAll(`.content__games-next`);for(let t of e)t.addEventListener(`click`,()=>{H(f,`prev`).then()});for(let e of t)e.addEventListener(`click`,()=>{H(f,`next`).then()});let n=document.querySelectorAll(`.content__games-menu__item-redirect, .content__games-mobile .content__games-menu__item`);for(let e of n)e instanceof HTMLElement&&_(e);R()}function R(){let e=document.querySelectorAll(`.content__games-showall`),t=document.querySelector(`.content__games-menu-popup:not(.content__games-mobile .content__games-menu-popup)`);if(!(!t||e.length===0)){if(t.parentElement){t.parentElement.removeChild(t);let e=document.getElementById(`content`);e?.appendChild(t)}for(let n of e)n.addEventListener(`click`,async e=>{e.stopPropagation(),await I(),t.style.display===`block`?B(t):z(t)});if(!t.dataset.outsideListenerAttached){let n=[...e];document.addEventListener(`click`,e=>{if(t.style.display!==`block`)return;let r=e.target;r instanceof Node&&!t.contains(r)&&!n.some(e=>e.contains(r))&&B(t)}),t.dataset.outsideListenerAttached=`true`}}}function z(e){let t=document.querySelector(`.content__games-controls`),n=document.getElementById(`content`);if(!t||!n)return;let r=t.getBoundingClientRect(),i=n.getBoundingClientRect();Object.assign(e.style,{top:`${r.top-i.top-6}px`,right:`${i.right-r.right-6}px`,left:`auto`,display:`block`,zIndex:`20`}),requestAnimationFrame(()=>{e.classList.remove(`fade-out`),e.classList.add(`fade-in`)})}function B(e){e.classList.remove(`fade-in`),e.classList.add(`fade-out`),setTimeout(()=>{e.style.display=`none`,e.classList.remove(`fade-out`)},250)}function V(){if(f)return f;let e=Array.from(document.querySelectorAll(`.content__games__hero-item`));if(e.length===0)return null;let t=Array.from(document.querySelectorAll(`.content__games-menu-popup-desktop .content__games-menu__item`)),n=Array.from(document.querySelectorAll(`.content__games-mobile .content__games-menu__item`)),r=[...t],i=r.find(e=>e.classList.contains(`active`)),a=i?r.indexOf(i):0;return f={gameItems:e,menuItems:{desktop:t,mobile:n},visibleItems:r,activeIndex:a>-1?a:0,isTransitioning:!1},f}async function H(e,t,n){await I();let r=e??V();if(!r||(f||=r,r.isTransitioning||r.visibleItems.length<=1))return;r.isTransitioning=!0;let i=r.visibleItems.length,a=r.activeIndex,o;if(t===`direct`&&n!==void 0){let e=r.gameItems[n];if(!e){r.isTransitioning=!1;return}let t=r.visibleItems.find(t=>t.dataset.section===e.dataset.section);if(!t){r.isTransitioning=!1;return}o=r.visibleItems.indexOf(t)}else o=t===`next`?(a+1)%i:(a-1+i)%i;o<0&&(o=0);let s=r.visibleItems[a],c=r.visibleItems[o],l=r.gameItems.find(e=>e.dataset.section===s.dataset.section),u=r.gameItems.find(e=>e.dataset.section===c.dataset.section);if(!l||!u){r.isTransitioning=!1;return}l.classList.add(`fade-out`);let d=u.querySelector(`.content__games__hero__art`);d&&!d.src&&d.dataset.src&&(d.src=d.dataset.src),setTimeout(()=>{let e=()=>{l.classList.remove(`active`,`fade-out`),u.classList.add(`active`,`fade-in`),[...r.menuItems.desktop,...r.menuItems.mobile].forEach(e=>{e.classList.toggle(`active`,e.dataset.section===u.dataset.section)}),setTimeout(()=>{u.classList.remove(`fade-in`),r.activeIndex=o,r.isTransitioning=!1},250)};d&&!d.complete?(d.onload=e,d.onerror=e):e()},250)}function U(){let e=document.querySelectorAll(s.SHOWCASE_PLAY);for(let t of e)t.addEventListener(`click`,N);let t=document.getElementById(`content__latest-changes__show-more`);t&&t.addEventListener(`click`,()=>{let e=document.querySelectorAll(`.content__latest-changes__commit-item.hidden`),n=Array.from(e).slice(0,10);n.forEach(e=>{e.classList.remove(`hidden`);let t=e.closest(`.content__latest-changes__timeline-group`);t&&t.classList.contains(`hidden`)&&t.classList.remove(`hidden`)}),document.querySelectorAll(`.content__latest-changes__commit-item.hidden`).length===0&&(t.style.display=`none`)}),L()}function W(){let e=document.querySelectorAll(s.TOC_SEARCH);for(let t of e)_(t)}function G(){let e=document.querySelectorAll(s.SELECTOR_ITEM);for(let t of e)t.addEventListener(`click`,K)}function K(e){let t=e.currentTarget;t instanceof HTMLElement&&(q(),t.className=`content__selectorbox--item selected`,oe(t),se(),l.directives.compileDirectives(),l.toc.createTOC(u.currentDocument),W(),l.headings.shareHeadings(),l.toc.highlightTOC())}function q(){let e=document.querySelectorAll(s.SELECTOR_ITEM);for(let t of e)t.className=`content__selectorbox--item`}function oe(e){let t=l.helper.h2Collection.filter(t=>t.id===e.dataset.open),n=document.getElementById(`content__currenth2`);n&&t.length>0&&(n.innerHTML=t[0].content)}function se(){let e=document.querySelectorAll(s.CONTENT_COLLAPSE);for(let t of e)t.addEventListener(`click`,l.headings.collapseHeadingStyle)}function ce(){let e=document.querySelector(s.SELECTOR_ITEM);e?.click()}let J=null;async function le(e){try{if(!J){let e=await import(`./markdown.mjs`);J=await e.initializeCompiler(l.helper)}l.helper.inEdit=!0;let t=document.querySelector(s.CONTENT);t&&(t.innerHTML=``);let n=document.getElementById(`edit-content`);if(!n){console.error(`Edit content container not found`);return}n.style.display=`block`,n.innerHTML=``;let r=de(e),i=await l.helper.asyncRead(r),a=document.createElement(`form`);a.className=`edit-content__form`,a.innerHTML=`
      <div class="edit-content__header">
        <div class="edit-content__title">
          <span class="material-symbols-rounded">edit_document</span>
          EDIT: ${e.section.toUpperCase()}
        </div>
        <p class="edit-content__subtitle">DOCUMENT: ${e.document.toUpperCase()} (${e.pageType.toUpperCase()})</p>
      </div>

      <div class="edit-content__main">
        <div class="edit-content__form-section">
          <div class="edit-content__credentials">
            <div class="edit-content__field-group">
              <label for="edit-content__username" class="edit-content__label">USERNAME</label>
              <input type="text" id="edit-content__username" class="edit-content__input" placeholder="Enter your username" required autocomplete="username">
            </div>
            <div class="edit-content__field-group">
              <label for="edit-content__password" class="edit-content__label">PASSWORD</label>
              <input type="password" id="edit-content__password" class="edit-content__input" placeholder="Enter your password" required autocomplete="current-password">
            </div>
          </div>

          <div class="edit-content__acknowledgment">
            <div class="edit-content__checkbox-container">
              <input type="checkbox" id="edit-content__ownership" class="edit-content__checkbox" required>
              <label for="edit-content__ownership" class="edit-content__checkbox-label">
                I have properly cited external sources used in my changes.
              </label>
            </div>
          </div>

          <div class="edit-content__advanced-options-wrapper">
            <button type="button" class="edit-content__advanced-toggle">
              ADVANCED OPTIONS
              <span class="material-symbols-rounded chevron">expand_circle_down</span>
            </button>
          </div>
          <div class="edit-content__advanced-content">
            <div class="edit-content__field-group">
              <label for="edit-content__pr-message" class="edit-content__label">PULL REQUEST MESSAGE (OPTIONAL)</label>
              <textarea id="edit-content__pr-message" class="edit-content__input edit-content__pr-message-input" placeholder="Add a message for your pull request..."></textarea>
            </div>
          </div>

          <div class="edit-content__actions">
            <button type="button" class="edit-content__button edit-content__button--cancel">
              <span class="material-symbols-rounded">cancel</span>
              CANCEL
            </button>
            <button type="button" class="edit-content__button edit-content__button--refresh">
              <span class="material-symbols-rounded">refresh</span>
              RENDER PAGE
            </button>
            <button type="submit" class="edit-content__button edit-content__button--submit" disabled>
              <span class="material-symbols-rounded">webhook</span>
              REQUEST CHANGES
            </button>
          </div>
        </div>

        <div class="edit-content__editor-container">
          <div class="edit-content__editor-header">
            <div class="edit-content__content-label">
              MARKDOWN CONTENT
              <span class="edit-content__content-info">Edit content below. Changes will be reviewed before publishing.</span>
            </div>
            <div class="edit-content__file-actions">
              <button type="button" class="edit-content__file-button" data-action="download">
                <span class="material-symbols-rounded">file_save</span>
              </button>
              <button type="button" class="edit-content__file-button" data-action="upload">
                <span class="material-symbols-rounded">upload_file</span>
              </button>
            </div>
          </div>
          <div id="edit-content__textarea" class="editor edit-content__textarea"></div>
        </div>
      </div>
    `,ue(a,e),n.appendChild(a);let o=document.querySelector(`#edit-content__textarea`);o&&await J.initializeEditor(i,o),Q().then()}catch(e){console.error(`Failed to load edit page:`,e);let t=document.getElementById(`edit-content`);t&&(t.style.display=`block`,t.innerHTML=`
        <div class="edit-content__error">
          <span class="material-symbols-rounded">error</span>
          <p>Failed to load edit interface. Please try again.</p>
        </div>
      `)}}function ue(e,t){let n=e.querySelector(`.edit-content__button--submit`),r=e.querySelector(`#edit-content__ownership`);e.addEventListener(`submit`,e=>{e.preventDefault(),r?.checked&&fe(t).then()}),r?.addEventListener(`change`,()=>{n&&(n.disabled=!r.checked)});let i=e.querySelector(`.edit-content__button--cancel`);i?.addEventListener(`click`,()=>{$();let e={document:u.currentDocument,section:u.currentDocument,redirect:`NONE`,pageType:x(u.currentDocument),isPopstate:!1};S(e).then()});let a=e.querySelector(`.edit-content__button--refresh`);a?.addEventListener(`click`,()=>{Q().then();let e=document.querySelector(`h1`);e&&e.scrollIntoView({behavior:`smooth`})});let o=e.querySelectorAll(`.edit-content__file-button`);for(let e of o){e.addEventListener(`click`,()=>{let t=e.dataset.action;t===`download`?he().then():t===`upload`&&ge()});let t=e.dataset.action===`download`?`Download markdown file`:`Upload markdown file`;l.helper.setTooltip(e,t)}let s=e.querySelector(`.edit-content__advanced-toggle`),c=e.querySelector(`.edit-content__advanced-content`);s?.addEventListener(`click`,()=>{s.classList.toggle(`open`),c?.classList.toggle(`open`)})}function de(e){switch(e.pageType){case`home`:return`${e.document.toLowerCase()}.md`;case`generic`:return`${e.document}.md`;case`tech`:return`tech/${e.document.toLowerCase()}.md`;default:return`tech/${e.document.toLowerCase()}.md`}}async function fe(e){if(d)return;d=!0;let t=document.querySelector(`.edit-content__button--submit`),n=document.querySelector(`#edit-content__textarea`),r=document.querySelector(`#edit-content__username`),i=document.querySelector(`#edit-content__password`),a=document.querySelector(`#edit-content__pr-message`);if(t&&Object.assign(t,{disabled:!0,innerHTML:`
        <span class="material-symbols-rounded">hourglass_empty</span>
        SUBMITTING...
      `}),X(),!n){d=!1,t&&Object.assign(t,{disabled:!1,innerHTML:`
          <span class="material-symbols-rounded">webhook</span>
          REQUEST CHANGES
        `});return}try{let t=r?.value.trim()??``,n=i?.value.trim()??``;if(t.startsWith(`+`)){let e=t.substring(1),r=await Z(n);await pe(e,r);return}let o=await J.getEditorContent()||``,s=t,c=e.document.toLowerCase(),l=a?.value.trim()??``,u=await Z(n),d=await fetch(`https://tteworker.vcentok.workers.dev/pr`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({username:s,password:u,document:c,content:o,prMessage:l})}),f=await d.json();Y(f)}catch(e){console.error(`Error sending POST request:`,e),Y({message:`Server error!`})}finally{d=!1,t&&Object.assign(t,{disabled:!1,innerHTML:`
          <span class="material-symbols-rounded">webhook</span>
          REQUEST CHANGES
        `})}}async function pe(e,t){let n=await fetch(`https://tteworker.vcentok.workers.dev/createuser`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({username:e,password:t})}),r=await n.json();Y(r)}function Y(e){let t=document.querySelector(`.edit-content__response`);if(!t){t=document.createElement(`div`),t.className=`edit-content__response`;let e=document.querySelector(`.edit-content__actions`);e?.parentNode?.insertBefore(t,e.nextSibling)}t.innerHTML=``;let{messageHtml:n,messageClass:r}=me(e);t.className=`edit-content__response ${r}`,t.innerHTML=n}function me(e){let{message:t,url:n,prNumber:r}=e;return t===`Username already exists`?{messageHtml:`Username already exists.`,messageClass:`error`}:t===`User created successfully`?{messageHtml:`User created successfully.`,messageClass:`success`}:t===`Error creating user`?{messageHtml:`Error creating user.`,messageClass:`error`}:t===`Invalid username or password`?{messageHtml:`Invalid username or password.`,messageClass:`error`}:t===`Pull Request created successfully!`&&r&&n?{messageHtml:`Contribution received! Follow it on <a href="${n}" target="_blank" rel="noopener noreferrer">PR${r}</a>.`,messageClass:`success`}:{messageHtml:`Server error!`,messageClass:`error`}}function X(){let e=document.querySelector(`.edit-content__response`);e&&(e.innerHTML=``,e.className=`edit-content__response`)}async function Z(e){let t=new TextEncoder().encode(e),n=await crypto.subtle.digest(`SHA-256`,t),r=Array.from(new Uint8Array(n));return r.map(e=>e.toString(16).padStart(2,`0`)).join(``)}async function Q(){let e=await J?.getEditorContent()||``;X();let t=await J?.parseText(e,l.helper.currentDocument,l.helper.currentSection,!0)||``,n={document:l.helper.currentDocument??u.currentDocument,section:l.helper.currentSection??``,redirect:`NONE`,pageType:x(u.currentDocument),isPopstate:!1},r=document.querySelector(s.CONTENT);r&&(r.style.minHeight=n.pageType===`tech`?c.MIN_HEIGHT_TECH:c.MIN_HEIGHT_STANDARD,n.pageType===`tech`&&(r.style.visibility=`hidden`),r.innerHTML=t,l.toc.clearHeadings(),l.toc.clearSectionTOC(),n.pageType===`tech`&&M(),A(n))}async function he(){let e=await J?.getEditorContent()||``,t=`${l.helper.currentDocument||`document`}.md`,n=new Blob([e],{type:`text/markdown;charset=utf-8`}),r=document.createElement(`a`);r.style.display=`none`,r.href=URL.createObjectURL(n),r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href)}function ge(){let e=document.createElement(`input`);e.type=`file`,e.accept=`.md,.txt,.markdown`,e.style.display=`none`,e.addEventListener(`change`,t=>{let n=t.target;if(!(n instanceof HTMLInputElement)||!n.files||n.files.length===0)return;let r=n.files[0],i=new FileReader;i.onload=e=>{let t=e.target?.result||null;J?.updateEditorContent(t)},i.onerror=()=>{console.error(`Error reading file`)},i.readAsText(r,`utf-8`),document.body.removeChild(e)}),document.body.appendChild(e),e.click()}function $(){let e=document.getElementById(`edit-content`);l.helper.inEdit=!1,e&&(e.style.display=`none`,e.innerHTML=``)}