var e=class e{isNavigationLocked;currentActiveSearchType;addPageChangeEventCallback;helperObj;searchBoxSelector="#nav-bar__searchbox";searchInputSelector="#nav-bar__search--input";searchHrSelector="#nav-bar__search--hr";static HARDCODED_FILTERS=["TALES OF","T","TO"];static MAX_TECH_RESULTS=12;constructor(e,t){this.isNavigationLocked=!1,this.currentActiveSearchType=null,this.addPageChangeEventCallback=e,this.helperObj=t,this.handleSearchBoxClick=this.handleSearchBoxClick.bind(this),this.handleInputKeyUp=this.handleInputKeyUp.bind(this),this.handleInputFocusIn=this.handleInputFocusIn.bind(this),this.handleSearchBoxFocusOut=this.handleSearchBoxFocusOut.bind(this)}initializeSearchIcons(){let e=document.querySelector(this.searchBoxSelector);if(!e)return;e.addEventListener("click",this.handleSearchBoxClick);let t=document.querySelector(this.searchInputSelector);t&&(t.addEventListener("keyup",this.handleInputKeyUp),t.addEventListener("focusin",this.handleInputFocusIn)),e.targetParam="search";let n=document.querySelector("#nav-bar__games--icon");n?.addEventListener("click",this.performGamesSearch.bind(this)),e.addEventListener("focusout",this.handleSearchBoxFocusOut)}initializeOnboardingIcon(){let e=document.querySelector("#content__home__onboarding--icon");e?.addEventListener("click",this.performGamesSearch.bind(this))}handleSearchBoxClick(e){if(this.isNavigationLocked)return;let t=e.currentTarget;if(!t||!(t instanceof HTMLElement))return;let n=t.targetParam;n&&(this.currentActiveSearchType=n,this.displaySearchBox("#nav-bar__search"))}displaySearchBox(e){if(this.isNavigationLocked)return;let t=document.querySelector(e);if(!t)return;t.removeEventListener("click",this.handleSearchBoxClick);let n=`${e}box`,o=`${e}--input`,i=document.querySelector(n),s=document.querySelector(o);if(!i)return;let{clientWidth:r}=document.body,l="search"===this.currentActiveSearchType&&r>=480?400:280;i.style.width=`${l}px`,"search"===this.currentActiveSearchType?s?.focus():i.focus()}handleSearchBoxFocusOut(e){let t=document.querySelector("#nav-bar__search");t&&(e.stopPropagation(),e.relatedTarget instanceof Node&&t.contains(e.relatedTarget)||this.clearSearchResults())}handleInputKeyUp(){this.filterSearchResults().then()}handleInputFocusIn(){this.filterSearchResults().then()}clearSearchResults(){let e=document.querySelector(this.searchBoxSelector);if(!e)return;for(let t of(this.isNavigationLocked=!0,Array.from(e.getElementsByClassName("button__redirect")).filter(e=>e instanceof HTMLElement)))t.style.display="none";let t=document.querySelector(this.searchHrSelector);t&&(t.style.display="none"),e.addEventListener("click",this.handleSearchBoxClick),this.isNavigationLocked=!1}async filterSearchResults(){let t="#nav-bar__search";document.querySelector(".nav-bar__search--results")||await this.populateSearchResults();let n=document.querySelector(`${t}--input`);if(!n)return;let o=n.value.toUpperCase().trim(),i=o.split(" "),s=document.querySelector(`${t}box`);if(!s)return;let r=Array.from(s.getElementsByClassName("button__redirect")).filter(e=>e instanceof HTMLElement),l=0;for(let t of r)if(this.shouldShowSearchResult(t,i,o)){let n=e.HARDCODED_FILTERS.some(e=>e===o||e.includes(o));if(n&&"game"===t.dataset.tag){t.style.display="block";continue}if(n){t.style.display="none";continue}let i=l<e.MAX_TECH_RESULTS||"game"===t.dataset.tag;t.style.display=i?"block":"none",i&&l++}else t.style.display="none";this.updateSearchSeparator(l,o)}shouldShowSearchResult(e,t,n){if(0===n.length)return!1;let o=[e.textContent??e.innerText??"",e.dataset.section??"",e.dataset.document??""].join(" ").toUpperCase();return t.every(e=>o.includes(e))}updateSearchSeparator(t,n){let o=document.querySelector(this.searchHrSelector);if(!o)return;let i=e.HARDCODED_FILTERS.some(e=>e===n||e.includes(n)),s=n.length>0&&(t>0||i);o.style.display=s?"block":"none"}performGamesSearch(){if(!document.querySelector(this.searchBoxSelector))return;this.clearSearchResults(),this.isNavigationLocked=!1;let e=document.querySelector(this.searchInputSelector);e&&(e.value="Tales of",e.focus())}async populateSearchResults(){let e=document.querySelector(this.searchBoxSelector);if(e)try{let{cachedSearchResultsHTML:t}=await import("./searchHTML-CzQdfouc.mjs"),n=await this.helperObj.decompress(t);for(let t of(e.insertAdjacentHTML("beforeend",'<hr id="nav-bar__search--hr" tabindex="0" style="display: none;">'+n),document.querySelectorAll("a.nav-bar__search--results")))t instanceof HTMLElement&&this.addPageChangeEventCallback(t);e.focus()}catch(e){console.error("Failed to load search results:",e)}}revealElementById(e){let t=document.getElementById(e);if(!t){let n=this.findH2SectionIndex(e);if(-1===n)return;let o=document.querySelectorAll(".content__selectorbox--item");o[n]?.click(),t=document.getElementById(e)}if(!t)return;let n=this.getHiddenElementClasses(t);if(n)for(let e of n)this.revealElementsByClassName(e)}findH2SectionIndex(e){let t=this.helperObj.h2Collection;return t?t.findIndex(t=>t.content.includes(`id="${e}"`)||t.id===e):-1}getHiddenElementClasses(e){if("H4"===e.tagName&&e.dataset.open)return e.dataset.open.split(" ");let t=e.parentNode;if(t?.className.includes("content__")){let e=t.firstElementChild;if(e?.dataset.open)return e.dataset.open.split(" ")}let n=t?.parentNode;if(n){let e=n.firstElementChild;if(e?.dataset.open)return e.dataset.open.split(" ")}return null}revealElementsByClassName(e){for(let t of document.getElementsByClassName(e))t instanceof HTMLElement&&t.hidden&&(t.hidden=!1,this.updateExpandIcon(t))}updateExpandIcon(e){let t=(e=>{let t=e.parentNode;if(t?.className.includes("content__"))return t.firstElementChild?.children[0]??null;let n=t?.parentNode;return n?.firstElementChild?.children[0]??null})(e);t instanceof HTMLElement&&t.classList.contains("rotated")&&t.classList.remove("rotated")}},t=class e{headings;ticking;helperObj;static VIEWPORT_THRESHOLD_RATIO=.25;static MIN_THRESHOLD_PIXELS=150;static TOC_OFFSET_PIXELS=-30;static MOBILE_TOC_WIDTH_BREAKPOINT=480;static MOBILE_TOC_WIDTH_LARGE=360;static MOBILE_TOC_WIDTH_SMALL=300;constructor(e){this.headings=[],this.ticking=!1,this.helperObj=e,document.addEventListener("scroll",this.handleScroll.bind(this),{passive:!0})}handleScroll(){!this.ticking&&this.helperObj.inTechPage&&(window.requestAnimationFrame(()=>{this.highlightTOC(),this.ticking=!1}),this.ticking=!0)}clearHeadings(){this.headings.length=0}createTOC(e){let t=this.initializeTOCElements();if(!t)return;let{tocBorder:n,selector:o,toc:i,tocMobile:s}=t;n.style.height=`calc(100% - ${o.offsetTop+150}px)`;let r="<p>ON THIS SECTION</p><hr>";i.innerHTML=r,s.innerHTML=r,this.populateHeadings();let l=this.generateTOCLinks(e);i.innerHTML=r.concat(l),s.innerHTML=r.concat(l)}initializeTOCElements(){let e=document.getElementById("content__tocborder"),t=document.getElementById("content__selector"),n=document.getElementById("content__toc"),o=document.getElementById("content__tocmobile");if(!e){if(!this.createTOCElements())return null;e=document.getElementById("content__tocborder"),t=document.getElementById("content__selector"),n=document.getElementById("content__toc"),o=document.getElementById("content__tocmobile")}return e&&t&&n&&o?{tocBorder:e,selector:t,toc:n,tocMobile:o}:null}createTOCElements(){if(!document.querySelector(".content__selectorbox--item.selected"))return null;let t=document.getElementById("content"),n=document.getElementById("content__selector");if(!t||!n)return null;let o=document.createElement("div");o.id="content__tocborder",t.appendChild(o);let i=document.createElement("div");if(i.id="content__toc",o.appendChild(i),this.helperObj.inEdit){let i=document.getElementById("edit-content");i&&(o.style.top=`${n.offsetTop+t.offsetTop-i.clientHeight+3*e.TOC_OFFSET_PIXELS}px`)}else o.style.top=`${n.offsetTop+t.offsetTop+e.TOC_OFFSET_PIXELS}px`;return this.createMobileTOCElements(),this.setupTOCEventListeners(),{tocBorder:o,selector:n,content:t}}createMobileTOCElements(){let e=document.getElementById("section-container__div");if(!e)return;let t=document.createElement("span");t.className="material-symbols-rounded",t.id="content__tocicon",t.innerHTML="menu_book",t.style.display="none",e.appendChild(t);let n=document.createElement("div");n.id="content__tocicon--box",n.tabIndex=0,n.style.width="0px",e.appendChild(n);let o=document.createElement("div");o.id="content__tocmobile",n.appendChild(o),this.helperObj.dragScrollElement(`#${n.id}`,1),this.helperObj.dragScrollElement("#content__toc",1)}setupTOCEventListeners(){let e=document.getElementById("content__tocicon"),t=document.getElementById("content__tocicon--box");e&&t&&(e.addEventListener("click",()=>this.handleTOCIconClick()),t.addEventListener("focusout",e=>{this.handleTOCBoxFocusOut(e)}))}handleTOCIconClick(){let t=document.getElementById("content__tocicon--box");if(!t)return;let n=document.body.clientWidth>=e.MOBILE_TOC_WIDTH_BREAKPOINT?e.MOBILE_TOC_WIDTH_LARGE:e.MOBILE_TOC_WIDTH_SMALL;Object.assign(t.style,{width:`${n}px`,display:"block"}),t.className="fadein",t.focus()}handleTOCBoxFocusOut(e){let t=document.getElementById("content__tocicon--box");t&&(e.stopPropagation(),t.className="fadeout")}populateHeadings(){this.headings.length=0;let e=document.querySelectorAll("#content__currenth2 h3"),t=document.querySelectorAll("#content__currenth2 h4");for(let t of e)this.headings.push({name:t.textContent??"",clientY:t.getBoundingClientRect().top,isH3:!0,obj:t,id:t.id});for(let e of t)this.headings.push({name:e.textContent??"",clientY:e.getBoundingClientRect().top,isH3:!1,obj:e,id:e.id});this.headings.sort((e,t)=>e.clientY-t.clientY)}generateTOCLinks(e){let t="";for(let n=0;n<this.headings.length;n++){let o=this.headings[n],i=o.isH3?"":" content__toc--search-h4",s=`content__toc--search button__redirect${i}`;t+=`<div data-document="${e}" data-section="${this.helperObj.currentSection}" data-redirect="#${o.id}" class="${s}" style="display: block;">${o.name}</div>`}return t}highlightTOC(){let{currentH3:e,currentH3Index:t,nextH3Index:n}=this.findCurrentH3();this.updateTOCHighlighting(e),this.updateH4Visibility(t,n)}findCurrentH3(){let t=null,n=0,o=0;for(let i=0;i<this.headings.length;i++){let s=this.headings[i];if(s.isH3)if(s.obj.getBoundingClientRect().top<=Math.max(window.innerHeight*e.VIEWPORT_THRESHOLD_RATIO,e.MIN_THRESHOLD_PIXELS)||null===t)t=s,n=i;else{o=i;break}}return{currentH3:t,currentH3Index:n,nextH3Index:o}}updateTOCHighlighting(e){if(e){for(let e of document.querySelectorAll(".content__toc--search.active"))e.classList.remove("active");for(let t of document.querySelectorAll(`.content__toc--search[data-redirect="#${e.id}"]`))t.classList.add("active")}}updateH4Visibility(e,t){for(let n=0;n<this.headings.length;n++){let o=this.headings[n];if(o.isH3)continue;let i=this.isH4WithinVisibleRange(n,e,t);for(let e of document.querySelectorAll(`.content__toc--search[data-redirect="#${o.id}"]`))i?(e.style.display="block",e.classList.add("active")):(e.style.display="none",e.classList.remove("active"))}}isH4WithinVisibleRange(e,t,n){return e>=t&&e<=n||0===n&&t>0&&e>=t||0===n&&0===t}clearSectionTOC(){for(let e of["content__tocicon","content__tocicon--box"]){let t=document.getElementById(e);t?.remove()}}};const n={yellow:"#f8d959",pink:"#fe796f",teal:"#45c9c9",green:"#58f15b",red:"#e74a41",lavender:"#c8a2b0",blue:"#205aaa"};var o=class{mouseDown;startX;scrollLeft;startY;scrollTop;scrollButton;rootElement;logoElement;rotateFlag;leaveCounter;currentVelocity;chromeVersionRegex=/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/;versionMap;currentSection;currentDocument;inTechPage;inEdit;addPageChangeEvent;fileList;h2Collection;constructor(e,t){this.mouseDown=!1,this.startX=0,this.scrollLeft=0,this.startY=0,this.scrollTop=0,this.scrollButton=null,this.rootElement=null,this.logoElement=null,this.rotateFlag=!1,this.leaveCounter=0,this.currentVelocity=0,this.versionMap=new Map,this.currentSection=void 0,this.currentDocument=void 0,this.inTechPage=!1,this.inEdit=!1,this.addPageChangeEvent=e,this.fileList=t,this.h2Collection=[]}updateStatus(e,t,n){this.currentDocument=e,this.currentSection=t,this.inTechPage=n,this.versionMap.clear()}logoInit(){let e=document.querySelector("#nav-bar__title");e?.addEventListener("mouseenter",this.startRotateLogo.bind(this)),e?.addEventListener("mouseleave",this.stopRotateLogo.bind(this)),this.logoElement=document.querySelector("#nav-bar__title__logo")}addLogoVelocity(){if(!this.rotateFlag&&0===this.leaveCounter){this.currentVelocity=4,this.leaveCounter=200,requestAnimationFrame(this.rotateLogo.bind(this));return}this.currentVelocity=4,this.leaveCounter=200}startRotateLogo(){this.rotateFlag||0!==this.leaveCounter?(this.rotateFlag=!0,this.leaveCounter=200):(this.rotateFlag=!0,requestAnimationFrame(this.rotateLogo.bind(this)))}stopRotateLogo(){this.rotateFlag=!1}rotateLogo(){if(this.logoElement??=document.querySelector("#nav-bar__title__logo"),!this.logoElement)return;let e=getComputedStyle(this.logoElement).getPropertyValue("transform");if("none"===e)return;let t=e.split("(")[1].split(")")[0].split(","),n=parseFloat(t[0]),o=180/Math.PI*Math.atan2(parseFloat(t[1]),n);this.rotateFlag?this.currentVelocity=Math.min(this.currentVelocity+.06,1.8):this.currentVelocity=Math.max(this.currentVelocity-.03,0),o=o<0?o+360:o;let i=this.currentVelocity+o;if(this.logoElement.style.transform=`rotate(${i}deg)`,this.rotateFlag){this.leaveCounter=200,requestAnimationFrame(this.rotateLogo.bind(this));return}this.leaveCounter--,this.currentVelocity<=0&&(this.leaveCounter=0),this.leaveCounter>0&&requestAnimationFrame(this.rotateLogo.bind(this))}scrollInit(){this.scrollButton=document.querySelector("#scroll__button--to-top"),this.rootElement=document.documentElement,this.scrollButton?.addEventListener("click",this.scrollToTop.bind(this)),window.addEventListener("scroll",this.handleScroll.bind(this))}handleScroll(){if(!this.rootElement)return;let e=this.rootElement.scrollHeight-this.rootElement.clientHeight,t=document.getElementById("content__selectorbox"),n=0;if(t){let e=document.body.getBoundingClientRect();n=Math.max(t.getBoundingClientRect().top-e.top,0)}(this.rootElement.scrollTop-n)/e>.05?this.scrollButton?.classList.add("scroll__button--to-top--show"):this.scrollButton?.classList.remove("scroll__button--to-top--show")}scrollToTop(){let e=document.getElementById("content__selectorbox"),t=0;if(e){let n=document.body.getBoundingClientRect();t=Math.max(e.getBoundingClientRect().top-n.top-20,0)}window.requestAnimationFrame(()=>{let e="smooth";if(navigator.userAgent.includes("Chrome")){let t=navigator.userAgent.match(this.chromeVersionRegex),n=Number(t?.[1]??130);!isNaN(n)&&n<130&&(e="auto")}this.rootElement?.scrollTo({top:t,behavior:e})})}setTooltip(e,t){e&&t&&(e.addEventListener("mouseover",()=>{this.loadTooltip(e,t)},{passive:!0}),e.addEventListener("mouseleave",()=>{this.unloadTooltip()},{passive:!0}))}loadTooltip(e,t){if(!e)return;document.getElementsByTagName("tooltip")[0]?.remove();let n=document.createElement("tooltip");n.id="nav-bar__tooltip",n.textContent=t;let o=e.getBoundingClientRect();o.left<window.innerWidth/2?Object.assign(n.style,{top:`${o.bottom-10}px`,left:`${o.right}px`}):Object.assign(n.style,{top:`${o.bottom-10}px`,right:`${window.innerWidth-o.left-10}px`}),document.body.appendChild(n)}unloadTooltip(){document.getElementsByTagName("tooltip")[0]?.remove()}dragScrollElement(e,t){let n=document.querySelector(e);if(!n)return;let o=e=>e instanceof MouseEvent?{x:e.pageX,y:e.pageY}:{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},i=e=>{this.mouseDown=!0;let t=o(e);this.startX=t.x-n.offsetLeft,this.scrollLeft=n.scrollLeft},s=e=>{this.mouseDown=!0;let t=o(e);this.startY=t.y-n.offsetTop,this.scrollTop=n.scrollTop},r=e=>{if(e.stopPropagation(),!this.mouseDown)return;let t=o(e).x-n.offsetLeft-this.startX;n.scrollLeft=this.scrollLeft-t},l=e=>{if(e.stopPropagation(),!this.mouseDown)return;let t=o(e).y-n.offsetTop-this.startY;n.scrollTop=this.scrollTop-t},c=()=>{this.mouseDown=!1},a={passive:!1},d={passive:!0};for(let[e,o,u]of 1===t?[["mousemove",l,a],["mousedown",s,d],["mouseup",c,d],["mouseleave",c,d],["touchmove",l,a],["touchstart",s,d],["touchend",c,d]]:[["mousemove",r,a],["mousedown",i,d],["mouseup",c,d],["mouseleave",c,d],["touchmove",r,a],["touchstart",i,d],["touchend",c,d]])n.addEventListener(e,o,u)}createMediaElement(e,t,n,o,i,s,r){let l,c=e.createElement("p");if(r?(c.classList.add("left"===r?"content__figure--float-left":"content__figure--float-right"),Object.assign(c.style,{opacity:"1"})):Object.assign(c.style,{opacity:"1",textAlign:"center"}),"img"===t)Object.assign(l=e.createElement("img"),{alt:s??"",loading:"lazy",src:n});else{Object.assign(l=e.createElement("video"),{preload:"metadata",controls:!0,muted:!0,loop:!0});let t=e.createElement("source");Object.assign(t,{src:n,type:"video/mp4"}),l.appendChild(t)}if(Object.assign(l,{draggable:!1}),r?Object.assign(l.style,{width:"100%",height:"auto",outline:"none",borderRadius:"8px"}):(Object.assign(l,{width:o,height:i}),l.classList.add("content__figure")),c.appendChild(l),s){let t=e.createElement("u");t.classList.add("content__figure-caption"),Object.assign(t.style,{whiteSpace:"pre"}),t.textContent=` ${s} `,c.appendChild(t)}return c}async asyncRead(e){let t=await this.loadFile(e);return!t||t.length<=1?"":t}async loadFile(e){return new Promise((t,n)=>{let o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=()=>{o.status>=200&&o.status<300?t(o.response):n({status:o.status,statusText:o.statusText})},o.onerror=()=>{n({status:o.status,statusText:o.statusText})},o.send()})}async compress(e){let t=new TextEncoder,n=new Response(new ReadableStream({start(n){n.enqueue(t.encode(e)),n.close()}}).pipeThrough(new CompressionStream("deflate-raw"))),o=await n.arrayBuffer();return"undefined"!=typeof Buffer?Buffer.from(o).toString("base64"):btoa(String.fromCharCode(...new Uint8Array(o)))}async decompress(e){let t;if("undefined"!=typeof Buffer)t=Buffer.from(e,"base64");else{let n=atob(e);t=new Uint8Array(n.length);for(let e=0;e<n.length;e++)t[e]=n.charCodeAt(e)}let n=new Response(new ReadableStream({start(e){e.enqueue(t),e.close()}}).pipeThrough(new DecompressionStream("deflate-raw")));return await n.text()}},i=class e{colorCollection;helperObj;static CHEVRON_UPDATE_DELAY=700;constructor(e){this.colorCollection=n,this.helperObj=e,this.collapseHeadingStyle=this.collapseHeadingStyle.bind(this)}collapseHeadings(){this.helperObj.dragScrollElement("#content__selectorbox",0),this.setupChevrons();let e=document.getElementById("content");null!==e&&(e.style.visibility="visible")}setupChevrons(){let e=this.getChevronElements();if(!e)return;let{chevronBox:t,chevronLeft:n,chevronRight:o,selectorBox:i}=e,s=()=>{let e=i.clientWidth,s=i.scrollWidth;e<s?Object.assign(t.style,{display:"block",left:`${i.getBoundingClientRect().right}px`}):t.style.display="none";let r=i.scrollLeft;n.classList.toggle("active",r>0),o.classList.toggle("active",r<s-e)};s(),this.setupChevronEventListeners(n,o,i,s)}getChevronElements(){let e=document.getElementById("content__mobilechevrons"),t=document.querySelector(".content__mobilechevrons--left"),n=document.querySelector(".content__mobilechevrons--right"),o=document.getElementById("content__selectorbox");return e&&t&&n&&o?{chevronBox:e,chevronLeft:t,chevronRight:n,selectorBox:o}:null}setupChevronEventListeners(e,t,n,o){window.addEventListener("resize",o),e.addEventListener("click",()=>{this.handleChevronClick(n,"left",o)}),t.addEventListener("click",()=>{this.handleChevronClick(n,"right",o)}),n.addEventListener("scroll",o)}handleChevronClick(t,n,o){let i=t.offsetWidth,s="left"===n?Math.max(0,t.scrollLeft-i):Math.min(t.scrollWidth-i,t.scrollLeft+i);t.scrollTo({left:s,behavior:"smooth"}),setTimeout(()=>o(),e.CHEVRON_UPDATE_DELAY)}collapseHeadingStyle(e){let t=e.currentTarget;if(!t||!(t instanceof HTMLElement)||!t.dataset.open)return;let n=t.dataset.open.split(" ");for(let e of n)this.toggleElementsByClassName(e,t,0===n.indexOf(e))}toggleElementsByClassName(e,t,n){for(let o of document.getElementsByClassName(e))o instanceof HTMLElement&&(o.hidden?(o.hidden=!1,this.updateExpandIcon(t)):n&&(o.hidden=!0,this.updateExpandIcon(t)))}updateExpandIcon(e){let t=e.children[0];t instanceof HTMLElement&&(t.classList.contains("rotated")?t.classList.remove("rotated"):t.classList.add("rotated"))}shareHeadings(){let e=document.location.pathname.substring(1),t=e.split("/");t.length>1&&(e=t[0]);let n=window.location.origin;for(let t of document.querySelectorAll("h3, h4")){let o=t;o.style.cursor="copy",o.addEventListener("click",()=>{let t=`${n}/${e}/${o.id}`;navigator.clipboard.writeText(t).catch(()=>{})})}}};const s=[{document:"./CONTRIBUTING",section:"How to Contribute",dim:"N/A",ref:"contributing"},{document:"HOME",section:"HOME",dim:"N/A",ref:""},{document:"./README",section:"README",dim:"N/A",ref:"readme"},{document:"./STYLING",section:"Document Styling",dim:"N/A",ref:"styling"},{document:"TOG",section:"Tales of Graces",dim:"3D",ref:"tog",platform:["Wii","PS3","Switch","PS4","PS5","XB1","XBS","PC"],initialRelease:2009,description:"Bonds Transcend Time"},{document:"TOG-B",section:"Tales of Graces",dim:"3D",ref:"tog-b"},{document:"TOG-C",section:"Tales of Graces",dim:"3D",ref:"tog-c"},{document:"TOA",section:"Tales of Arise",dim:"3D",ref:"toa",platform:["PS4","PS5","XB1","XBS","PC"],initialRelease:2021,description:"Challenge the Fate That Binds You"},{document:"TOA-B",section:"Tales of Arise",dim:"3D",ref:"toa-b"},{document:"TOA-C",section:"Tales of Arise",dim:"3D",ref:"toa-c"},{document:"TOV",section:"Tales of Vesperia",dim:"3D",ref:"tov",platform:["360","PS3","Switch","PS4","PS5","XB1","XBS","PC"],initialRelease:2008,description:"To Each, Their Own Justice"},{document:"TOV-B",section:"Tales of Vesperia",dim:"3D",ref:"tov-b"},{document:"TOV-C",section:"Tales of Vesperia",dim:"3D",ref:"tov-c"},{document:"TODPS2",section:"Tales of Destiny",dim:"2D",ref:"todps2",platform:["PS2"],initialRelease:2006,description:"Liberate Your Destiny"},{document:"TODPS2-B",section:"Tales of Destiny",dim:"2D",ref:"todps2-b"},{document:"TODPS2-C",section:"Tales of Destiny",dim:"2D",ref:"todps2-c"},{document:"TOL",section:"Tales of Legendia",dim:"2D",ref:"tol",platform:["PS2"],initialRelease:2005,description:"Let Your Faith Give Birth to Power"},{document:"TOL-B",section:"Tales of Legendia",dim:"2D",ref:"tol-b"},{document:"TOL-C",section:"Tales of Legendia",dim:"2D",ref:"tol-c"},{document:"TOS",section:"Tales of Symphonia",dim:"3D",ref:"tos",platform:["GCN","PS2","PS3","PC","Switch","PS4","XB1"],initialRelease:2003,description:"The Epic Battle for Survival"},{document:"TOS-B",section:"Tales of Symphonia",dim:"3D",ref:"tos-b"},{document:"TOS-C",section:"Tales of Symphonia",dim:"3D",ref:"tos-c"},{document:"TOTA",section:"Tales of the Abyss",dim:"3D",ref:"tota",platform:["PS2","3DS"],initialRelease:2005,description:"Learning Why One Exists"},{document:"TOTA-B",section:"Tales of the Abyss",dim:"3D",ref:"tota-b"},{document:"TOTA-C",section:"Tales of the Abyss",dim:"3D",ref:"tota-c"},{document:"TOX",section:"Tales of Xillia",dim:"3D",ref:"tox",platform:["PS3"],initialRelease:2011,description:"When Worlds Overlap, Belief Lights the Way"},{document:"TOX-B",section:"Tales of Xillia",dim:"3D",ref:"tox-b"},{document:"TOX-C",section:"Tales of Xillia",dim:"3D",ref:"tox-c"},{document:"TOX2",section:"Tales of Xillia 2",dim:"3D",ref:"tox2",platform:["PS3"],initialRelease:2012,description:"The Power of Choice"},{document:"TOX2-B",section:"Tales of Xillia 2",dim:"3D",ref:"tox2-b"},{document:"TOX2-C",section:"Tales of Xillia 2",dim:"3D",ref:"tox2-c"},{document:"TOZ",section:"Tales of Zestiria",dim:"3D",ref:"toz",platform:["PS3","PS4","PC"],initialRelease:2015,description:"Legends Beget Hope"},{document:"TOZ-B",section:"Tales of Zestiria",dim:"3D",ref:"toz-b"},{document:"TOZ-C",section:"Tales of Zestiria",dim:"3D",ref:"toz-c"}];var r=class e{helperObj;static ARTICLE_SELECTOR_SELECTOR=".content__article-selector";static TAGGING_COMPUTED_SELECTOR=".tagging-computed";static VERSION_TRIGGER_SELECTOR="[data-tte-version-trigger]";static TODO_TRIGGER_SELECTOR="[data-tte-todo-trigger]";static MEDIA_ICON_SELECTOR="[data-tte-media-icon]";static TABLE_HEADERS_SELECTOR="th";static SPOILER_SELECTOR=".spoiler";handlePageChange;editPage;constructor(e,t,n){this.compileDirectives=this.compileDirectives.bind(this),this.sortTables=this.sortTables.bind(this),this.treatSpoilers=this.treatSpoilers.bind(this),this.handlePageChange=t,this.editPage=n,this.helperObj=e}compileEvents(){let t=document.querySelectorAll(e.TAGGING_COMPUTED_SELECTOR),n=document.querySelectorAll(e.ARTICLE_SELECTOR_SELECTOR);if(this.helperObj.inEdit){let e=document.querySelector("div.content__article-selector");e&&this.helperObj.setTooltip(e,"Article selection does not function on edit mode.")}for(let e of n)this.setupArticleSelectorEventListeners(e);for(let e of t){let t=JSON.parse((e.dataset.tags??"{}").replace(/'/g,'"'));if(t.versions&&this.setupVersionEventListeners(e,t.versions),t.todo&&this.setupTodoEventListeners(e),t.media&&!1===t.forcedmedia&&this.setupMediaEventListeners(e),e.classList.contains("content__redirect"))if(t.document&&this.helperObj.inEdit){let n=`Redirects to: ${t.document} - ${t.redirect}`;this.helperObj.setTooltip(e,n)}else this.helperObj.addPageChangeEvent(e)}}setupArticleSelectorEventListeners(e){let t=e.querySelector(".content__article-selector--button"),n=e.querySelector(".content__article-selector--menu"),o=e.querySelectorAll(".content__article-selector--item");if(t&&n&&"true"!==e.dataset.initialized){for(let i of(t.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),this.toggleArticleSelector(t,n)}),o))i.addEventListener("click",o=>{o.stopPropagation(),o.preventDefault(),this.selectArticleSelectorItem(e,t,n,i)});document.addEventListener("click",o=>{let i=o.target;e.contains(i)||this.closeArticleSelector(t,n)}),t.addEventListener("blur",()=>{setTimeout(()=>{e.contains(document.activeElement)||this.closeArticleSelector(t,n)},150)}),e.dataset.initialized="true"}}toggleArticleSelector(e,t){t.classList.contains("open")?this.closeArticleSelector(e,t):this.openArticleSelector(e,t)}openArticleSelector(e,t){e.classList.add("open"),t.classList.add("open"),e.setAttribute("aria-expanded","true")}closeArticleSelector(e,t){e.classList.remove("open"),t.classList.remove("open"),e.setAttribute("aria-expanded","false")}selectArticleSelectorItem(e,t,n,o){if(this.helperObj.inEdit)return void this.closeArticleSelector(t,n);if(o.classList.contains("content__article-selector--edit")){this.closeArticleSelector(t,n),this.editPage({document:this.helperObj.currentDocument??"",section:this.helperObj.currentSection??"",pageType:"tech"});return}this.updateActiveItemState(e,o),this.updateButtonDisplay(t,o);let i=o.dataset.option;i&&(e.dataset.active=i),this.closeArticleSelector(t,n);let r=o.dataset.document;if(!r||!s.some(e=>e.document===r))return;let l={document:r??"",section:o.dataset.section??"",pageType:"tech"};this.handlePageChange(l)}updateActiveItemState(e,t){for(let t of e.querySelectorAll(".content__article-selector--item:not(.content__article-selector--edit)"))t.classList.remove("active");t.classList.add("active")}updateButtonDisplay(e,t){let n=t.querySelector(".material-symbols-rounded"),o=t.textContent?.trim().replace(/^(group|swords|settings)\s*/,"")??"",i=e.querySelector(".material-symbols-rounded:not(.content__article-selector--chevron)");i&&n&&(i.textContent=n.textContent);let s=e.querySelector(".content__article-selector--label");s&&(s.textContent=o)}setupVersionEventListeners(t,n){let o=t.querySelector(e.VERSION_TRIGGER_SELECTOR);if(!o)return;let i=`Version: ${n}.`;this.helperObj.setTooltip(o,i)}setupTodoEventListeners(t){let n=t.querySelector(e.TODO_TRIGGER_SELECTOR);n&&this.helperObj.setTooltip(n,"This section needs work, is not confirmed or needs testing.")}setupMediaEventListeners(t){let n=t.querySelector(e.MEDIA_ICON_SELECTOR);if(!n)return;let o=n.dataset.mediaSrc,i=n.dataset.mediaType,s=n.dataset.mediaCaption;o&&i&&n.addEventListener("click",()=>{this.handleMediaIconClick(t,o,i,s)},{passive:!0})}handleMediaIconClick(e,t,n,o){let i=document.querySelector(`p[data-media="${t}"]`);if(i)return void i.remove();let s=this.helperObj.createMediaElement(document,n,t,640,480,o);s.dataset.media=t,e.parentNode?.insertBefore(s,e.nextSibling)}compileDirectives(){this.compileEvents(),this.sortTables(),this.treatSpoilers()}sortTables(){for(let t of document.querySelectorAll(e.TABLE_HEADERS_SELECTOR)){let e=t;e.innerHTML+='<span class="material-symbols-rounded">swap_vert</span>',e.addEventListener("click",()=>{this.handleTableHeaderClick(e)})}}handleTableHeaderClick(e){let t=e.closest("table"),n=t?.querySelector("tbody")??null;if(!n)return;let o=Array.from(n.querySelectorAll("tr")),i=Array.from(e.parentNode?.children??[]).indexOf(e),s="true"!==e.dataset.asc,r=(e,t)=>e.children[t]?.textContent?.trim()??"";for(let e of o.toSorted((e,t)=>{let n=r(s?e:t,i),o=r(s?t:e,i);if(""===n||""===o)return n.localeCompare(o);let l=Number(n),c=Number(o);return isNaN(l)||isNaN(c)?n.localeCompare(o):l-c}))n.appendChild(e);e.dataset.asc=s.toString()}treatSpoilers(){for(let t of document.querySelectorAll(e.SPOILER_SELECTOR))t.addEventListener("click",e=>{let t=e.currentTarget;t instanceof HTMLElement&&(t.style.background="transparent")},{passive:!0})}};const l={CONTENT:"#content",NAV_BAR:"#nav-bar",SEARCH_INPUT:"#nav-bar__search--input",CONTENT_SELECTOR:"#content__selector",META_DESCRIPTION:'meta[name="description"]',H1:"h1",TOC_SEARCH:".content__toc--search",SELECTOR_ITEM:".content__selectorbox--item",CONTENT_COLLAPSE:".content__collapse",CONTENT_REDIRECT:"span.content__redirect",SHOWCASE_PLAY:".content__home__showcase-item--play",SHOWCASE_VIDEO:".content__home__showcase-item--video",HOME_UPDATED:".content__latest-changes__commit-changes-link",HOME_GAMES:".content__games__game-card__article-item"},c={MIN_HEIGHT_STANDARD:"600px",MIN_HEIGHT_TECH:"100vh",REDIRECT_DELAY:250,VIDEO_FADE_DELAY:50,VIDEO_REMOVE_DELAY:500},a={helper:new o(m,s),headings:{},directives:{},search:{},toc:{}};a.headings=new i(a.helper),a.directives=new r(a.helper,E,H),a.search=new e(m,a.helper),a.toc=new t(a.helper);const d={parsedDocuments:new Map,currentDocument:"",katexLoaded:!1,pageContent:""};let u=!1;function h(){(function(){for(let e of["div#nav-bar__title","p.footer-container__help--links","img#title-text__img"])for(let t of document.querySelectorAll(e))m(t)})(),a.search.initializeSearchIcons(),a.search.initializeOnboardingIcon(),a.helper.scrollInit(),a.helper.logoInit(),window.addEventListener("popstate",e=>{e.preventDefault(),e.stopPropagation(),E(e.state?{...e.state,isPopstate:!0}:{document:"HOME",section:"HOME",pageType:"home",isPopstate:!0}).then()}),function(){let e=document.location.pathname.substring(1);if(!e){let e=f({document:"HOME",section:"HOME"});e.isPopstate=!0,E(e).then();return}let t=e.split("/"),n=t[0]||"",o=t[1]||"",i=s.find(e=>e.ref===n);if(i){let t=f({document:i.document,section:i.section,redirect:o?`#${o}`:void 0});t.isPopstate=!0,E(t).then(),window.history.replaceState(t,i.section,e)}else E(f({document:"HOME",section:"HOME"})).then()}()}function m(e){_(),e.removeEventListener("click",p),e.addEventListener("click",p)}function p(e){e.preventDefault(),e.stopPropagation(),_();let t=e.currentTarget;t instanceof HTMLElement&&E(f(t.dataset)).then()}function _(){let e=document.querySelector(l.SEARCH_INPUT);e&&(document.activeElement?.blur(),e.blur())}function f(e){let t=e.document||"";return{document:t,section:e.section||"",redirect:e.redirect,pageType:g(t),isPopstate:!1}}function g(e){return"HOME"===e?"home":e.includes("./")?"generic":"tech"}async function E(e){"tech"===e.pageType&&await T(),await y(e),function(e){var t;if(d.currentDocument===e.document&&"tech"===e.pageType&&e.redirect&&"NONE"!==e.redirect){(function(e){if(e.redirect){a.search.revealElementById(e.redirect.substring(1));let t=document.querySelector(e.redirect)??document.querySelector(l.CONTENT_SELECTOR);t?.scrollIntoView({behavior:"smooth"})}else L()})(e),b(e);return}q(),d.currentDocument=e.document,function(e){let t=document.getElementById("content");t&&(t.style.minHeight="tech"===e.pageType?c.MIN_HEIGHT_TECH:c.MIN_HEIGHT_STANDARD,"tech"===e.pageType&&(t.style.visibility="hidden"),a.toc.clearHeadings(),a.toc.clearSectionTOC(),a.helper.updateStatus(e.document,e.section,"tech"===e.pageType),t.innerHTML=d.pageContent,"tech"===e.pageType&&C())}(e),function(e){let t="tech"===e.pageType?`TTE - ${e.section}`:"Tales Tech Encyclopaedia",n="tech"===e.pageType?`Tales Tech Encyclopaedia (TTE) article on ${e.section}.`:"Tales Tech Encyclopaedia (TTE), is a project that aims to document techniques and mechanics on the games of the 'Tales of Series'.";document.title=t;let o=document.querySelector(l.META_DESCRIPTION);o?.setAttribute("content",n)}(e),b(e),v(e),"tech"===(t=e).pageType&&t.redirect&&"NONE"!==t.redirect?setTimeout(()=>{a.search.revealElementById(t.redirect.substring(1));let e=document.querySelector(t.redirect)??document.querySelector(l.CONTENT_SELECTOR);e?.scrollIntoView({behavior:"smooth"})},c.REDIRECT_DELAY):L()}(e)}async function T(){if(!d.katexLoaded)return new Promise(e=>{let t=document.createElement("link");Object.assign(t,{rel:"stylesheet",crossOrigin:"anonymous",href:"styles/katex.min.css"}),t.onload=()=>{d.katexLoaded=!0,e()},document.head.appendChild(t)})}async function y(e){a.search.clearSearchResults(),a.helper.addLogoVelocity(),d.pageContent=await S(e)}async function S(e){let t=e.document;if(d.parsedDocuments.has(t))return d.parsedDocuments.get(t)??"";let n=function(e){switch(e.pageType){case"home":return`./${e.document.toLowerCase()}.html`;case"generic":return`./${e.document}.html`;case"tech":return`./tech/${e.document.toLowerCase()}.html`}}(e),o=await a.helper.asyncRead(n);return d.parsedDocuments.set(t,o),o}function b(e){if(e.isPopstate||a.helper.inEdit)return;let t=function(e){switch(e.pageType){case"home":return"/";case"generic":return`/${e.document.toLowerCase()}`;case"tech":{let t=`/${e.document.toLowerCase()}`;return e.redirect&&"NONE"!==e.redirect?`${t}/${e.redirect.substring(1)}`:t}}}(e);window.history.pushState(e,document.title,t)}function v(e){("home"===e.pageType||"generic"===e.pageType)&&a.directives.compileDirectives(),a.toc.createTOC(d.currentDocument),A(),a.headings.shareHeadings(),"home"===e.pageType?(function(){for(let e of document.querySelectorAll(`${l.CONTENT_REDIRECT}, ${l.HOME_UPDATED}, ${l.HOME_GAMES}`))m(e)}(),function(){for(let e of document.querySelectorAll(l.SHOWCASE_PLAY))e.addEventListener("click",O);let e=document.getElementById("content__latest-changes__show-more");if(!e)return;e.addEventListener("click",()=>{Array.from(document.querySelectorAll(".content__latest-changes__commit-item.hidden")).slice(0,10).forEach(e=>{e.classList.remove("hidden");let t=e.closest(".content__latest-changes__timeline-group");t&&t.classList.contains("hidden")&&t.classList.remove("hidden")}),0===document.querySelectorAll(".content__latest-changes__commit-item.hidden").length&&(e.style.display="none")});let t=document.getElementById("content__games-section__show-more");t&&t.addEventListener("click",()=>{Array.from(document.querySelectorAll(".content__games__game-card.hidden")).slice(0,3).forEach(e=>{e.classList.remove("hidden")}),0===document.querySelectorAll(".content__games__game-card.hidden").length&&(t.style.display="none")})}(),a.search.initializeOnboardingIcon()):"tech"===e.pageType&&(a.headings.collapseHeadings(),function(){for(let e of document.querySelectorAll(l.SELECTOR_ITEM))e.addEventListener("click",I)}(),function(){let e=document.querySelector(l.SELECTOR_ITEM);e?.click()}())}function C(){let e=document.querySelector(l.H1);if(!e)return;let t=e.dataset.h2Collection;t&&(e.removeAttribute("data-h2-collection"),a.helper.h2Collection=JSON.parse(t))}function L(){document.querySelector(l.NAV_BAR)?.scrollIntoView({behavior:"smooth"})}function O(e){let t=e.currentTarget;t instanceof HTMLElement&&("play_circle"===t.innerHTML?function(e){e.innerHTML="stop_circle";let t=document.createElement("video");Object.assign(t,{src:e.dataset.video||"",className:l.SHOWCASE_VIDEO.substring(1),autoplay:!0,controls:!1,muted:!0,loop:!0}),e.parentElement?.appendChild(t),setTimeout(()=>{t.style.opacity="1"},c.VIDEO_FADE_DELAY)}(t):function(e){let t=e.parentElement?.querySelector(l.SHOWCASE_VIDEO);t?(t.style.opacity="0",setTimeout(()=>{t.remove(),e.innerHTML="play_circle"},c.VIDEO_REMOVE_DELAY)):e.innerHTML="play_circle"}(t))}function A(){for(let e of document.querySelectorAll(l.TOC_SEARCH))m(e)}function I(e){let t=e.currentTarget;t instanceof HTMLElement&&(function(){for(let e of document.querySelectorAll(l.SELECTOR_ITEM))e.className="content__selectorbox--item"}(),t.className="content__selectorbox--item selected",function(e){let t=a.helper.h2Collection.filter(t=>t.id===e.dataset.open),n=document.getElementById("content__currenth2");n&&t.length>0&&(n.innerHTML=t[0].content)}(t),function(){for(let e of document.querySelectorAll(l.CONTENT_COLLAPSE))e.addEventListener("click",a.headings.collapseHeadingStyle)}(),a.directives.compileDirectives(),a.toc.createTOC(d.currentDocument),A(),a.headings.shareHeadings(),a.toc.highlightTOC())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h();let w=null;async function H(e){try{if(!w){let e=await import("./markdown.mjs");w=await e.initializeCompiler(a.helper)}a.helper.inEdit=!0;let t=document.querySelector(l.CONTENT);t&&(t.innerHTML="");let n=document.getElementById("edit-content");if(!n)return void console.error("Edit content container not found");n.style.display="block",n.innerHTML="";let o=function(e){switch(e.pageType){case"home":return`${e.document.toLowerCase()}.md`;case"generic":return`${e.document}.md`;default:return`tech/${e.document.toLowerCase()}.md`}}(e),i=await a.helper.asyncRead(o),s=document.createElement("form");s.className="edit-content__form",s.innerHTML=`
      <div class="edit-content__header">
        <div class="edit-content__title">
          <span class="material-symbols-rounded">edit_document</span>
          EDIT: ${e.section.toUpperCase()}
        </div>
        <p class="edit-content__subtitle">DOCUMENT: ${e.document.toUpperCase()} (${e.pageType.toUpperCase()})</p>
      </div>

      <div class="edit-content__main">
        <div class="edit-content__form-section">
          <div class="edit-content__credentials">
            <div class="edit-content__field-group">
              <label for="edit-content__username" class="edit-content__label">USERNAME</label>
              <input type="text" id="edit-content__username" class="edit-content__input" placeholder="Enter your username" required autocomplete="username">
            </div>
            <div class="edit-content__field-group">
              <label for="edit-content__password" class="edit-content__label">PASSWORD</label>
              <input type="password" id="edit-content__password" class="edit-content__input" placeholder="Enter your password" required autocomplete="current-password">
            </div>
          </div>

          <div class="edit-content__acknowledgment">
            <div class="edit-content__checkbox-container">
              <input type="checkbox" id="edit-content__ownership" class="edit-content__checkbox" required>
              <label for="edit-content__ownership" class="edit-content__checkbox-label">
                I have properly cited external sources used in my changes.
              </label>
            </div>
          </div>

          <div class="edit-content__advanced-options-wrapper">
            <button type="button" class="edit-content__advanced-toggle">
              ADVANCED OPTIONS
              <span class="material-symbols-rounded chevron">expand_circle_down</span>
            </button>
          </div>
          <div class="edit-content__advanced-content">
            <div class="edit-content__field-group">
              <label for="edit-content__pr-message" class="edit-content__label">PULL REQUEST MESSAGE (OPTIONAL)</label>
              <textarea id="edit-content__pr-message" class="edit-content__input edit-content__pr-message-input" placeholder="Add a message for your pull request..."></textarea>
            </div>
          </div>

          <div class="edit-content__actions">
            <button type="button" class="edit-content__button edit-content__button--cancel">
              <span class="material-symbols-rounded">cancel</span>
              CANCEL
            </button>
            <button type="button" class="edit-content__button edit-content__button--refresh">
              <span class="material-symbols-rounded">refresh</span>
              RENDER PAGE
            </button>
            <button type="submit" class="edit-content__button edit-content__button--submit" disabled>
              <span class="material-symbols-rounded">webhook</span>
              REQUEST CHANGES
            </button>
          </div>
        </div>

        <div class="edit-content__editor-container">
          <div class="edit-content__editor-header">
            <div class="edit-content__content-label">
              MARKDOWN CONTENT
              <span class="edit-content__content-info">Edit content below. Changes will be reviewed before publishing.</span>
            </div>
            <div class="edit-content__file-actions">
              <button type="button" class="edit-content__file-button" data-action="download">
                <span class="material-symbols-rounded">file_save</span>
              </button>
              <button type="button" class="edit-content__file-button" data-action="upload">
                <span class="material-symbols-rounded">upload_file</span>
              </button>
            </div>
          </div>
          <div id="edit-content__textarea" class="editor edit-content__textarea"></div>
        </div>
      </div>
    `,function(e,t){let n=e.querySelector(".edit-content__button--submit"),o=e.querySelector("#edit-content__ownership");e.addEventListener("submit",e=>{e.preventDefault(),o?.checked&&D(t).then()}),o?.addEventListener("change",()=>{n&&(n.disabled=!o.checked)});let i=e.querySelector(".edit-content__button--cancel");i?.addEventListener("click",()=>{q(),E({document:d.currentDocument,section:d.currentDocument,redirect:"NONE",pageType:g(d.currentDocument),isPopstate:!1}).then()});let s=e.querySelector(".edit-content__button--refresh");for(let t of(s?.addEventListener("click",()=>{M().then();let e=document.querySelector("h1");e&&e.scrollIntoView({behavior:"smooth"})}),e.querySelectorAll(".edit-content__file-button"))){t.addEventListener("click",()=>{let e=t.dataset.action;"download"===e?k().then():"upload"===e&&function(){let e=document.createElement("input");e.type="file",e.accept=".md,.txt,.markdown",e.style.display="none",e.addEventListener("change",t=>{let n=t.target;if(!(n instanceof HTMLInputElement)||!n.files||0===n.files.length)return;let o=n.files[0],i=new FileReader;i.onload=e=>{let t=e.target?.result||null;w?.updateEditorContent(t)},i.onerror=()=>{console.error("Error reading file")},i.readAsText(o,"utf-8"),document.body.removeChild(e)}),document.body.appendChild(e),e.click()}()});let e="download"===t.dataset.action?"Download markdown file":"Upload markdown file";a.helper.setTooltip(t,e)}let r=e.querySelector(".edit-content__advanced-toggle"),l=e.querySelector(".edit-content__advanced-content");r?.addEventListener("click",()=>{r.classList.toggle("open"),l?.classList.toggle("open")})}(s,e),n.appendChild(s);let r=document.querySelector("#edit-content__textarea");r&&await w.initializeEditor(i,r),M().then()}catch(t){console.error("Failed to load edit page:",t);let e=document.getElementById("edit-content");e&&(e.style.display="block",e.innerHTML=`
        <div class="edit-content__error">
          <span class="material-symbols-rounded">error</span>
          <p>Failed to load edit interface. Please try again.</p>
        </div>
      `)}}async function D(e){if(u)return;u=!0;let t=document.querySelector(".edit-content__button--submit"),n=document.querySelector("#edit-content__textarea"),o=document.querySelector("#edit-content__username"),i=document.querySelector("#edit-content__password"),s=document.querySelector("#edit-content__pr-message");if(t&&Object.assign(t,{disabled:!0,innerHTML:`
        <span class="material-symbols-rounded">hourglass_empty</span>
        SUBMITTING...
      `}),x(),!n){u=!1,t&&Object.assign(t,{disabled:!1,innerHTML:`
          <span class="material-symbols-rounded">webhook</span>
          REQUEST CHANGES
        `});return}try{let t=o?.value.trim()??"",n=i?.value.trim()??"";if(t.startsWith("+")){let e=t.substring(1),o=await B(n);await R(e,o);return}let r=await w.getEditorContent()||"",l=e.document.toLowerCase(),c=s?.value.trim()??"",a=await B(n),d=await fetch("https://tteworker.vcentok.workers.dev/pr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a,document:l,content:r,prMessage:c})}),u=await d.json();N(u)}catch(e){console.error("Error sending POST request:",e),N({message:"Server error!"})}finally{u=!1,t&&Object.assign(t,{disabled:!1,innerHTML:`
          <span class="material-symbols-rounded">webhook</span>
          REQUEST CHANGES
        `})}}async function R(e,t){let n=await fetch("https://tteworker.vcentok.workers.dev/createuser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});N(await n.json())}function N(e){let t=document.querySelector(".edit-content__response");if(!t){(t=document.createElement("div")).className="edit-content__response";let e=document.querySelector(".edit-content__actions");e?.parentNode?.insertBefore(t,e.nextSibling)}t.innerHTML="";let{messageHtml:n,messageClass:o}=function(e){let{message:t,url:n,prNumber:o}=e;return"Username already exists"===t?{messageHtml:"Username already exists.",messageClass:"error"}:"User created successfully"===t?{messageHtml:"User created successfully.",messageClass:"success"}:"Error creating user"===t?{messageHtml:"Error creating user.",messageClass:"error"}:"Invalid username or password"===t?{messageHtml:"Invalid username or password.",messageClass:"error"}:"Pull Request created successfully!"===t&&o&&n?{messageHtml:`Contribution received! Follow it on <a href="${n}" target="_blank" rel="noopener noreferrer">PR${o}</a>.`,messageClass:"success"}:{messageHtml:"Server error!",messageClass:"error"}}(e);t.className=`edit-content__response ${o}`,t.innerHTML=n}function x(){let e=document.querySelector(".edit-content__response");e&&(e.innerHTML="",e.className="edit-content__response")}async function B(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function M(){let e=await w?.getEditorContent()||"";x();let t=await w?.parseText(e,a.helper.currentDocument,a.helper.currentSection,!0)||"",n={document:a.helper.currentDocument??d.currentDocument,section:a.helper.currentSection??"",redirect:"NONE",pageType:g(d.currentDocument),isPopstate:!1},o=document.querySelector(l.CONTENT);o&&(o.style.minHeight="tech"===n.pageType?c.MIN_HEIGHT_TECH:c.MIN_HEIGHT_STANDARD,"tech"===n.pageType&&(o.style.visibility="hidden"),o.innerHTML=t,a.toc.clearHeadings(),a.toc.clearSectionTOC(),"tech"===n.pageType&&C(),v(n))}async function k(){let e=await w?.getEditorContent()||"",t=`${a.helper.currentDocument||"document"}.md`,n=new Blob([e],{type:"text/markdown;charset=utf-8"}),o=document.createElement("a");o.style.display="none",o.href=URL.createObjectURL(n),o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)}function q(){let e=document.getElementById("edit-content");a.helper.inEdit=!1,e&&(e.style.display="none",e.innerHTML="")}